var ti=Object.defineProperty,ei=Object.defineProperties;var ni=Object.getOwnPropertyDescriptors;var zt=Object.getOwnPropertySymbols;var Qe=Object.prototype.hasOwnProperty,Je=Object.prototype.propertyIsEnumerable;var xt=(n,t)=>(t=Symbol[n])?t:Symbol.for("Symbol."+n),ce=n=>{throw TypeError(n)},ht=Math.pow,he=(n,t,e)=>t in n?ti(n,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):n[t]=e,et=(n,t)=>{for(var e in t||(t={}))Qe.call(t,e)&&he(n,e,t[e]);if(zt)for(var e of zt(t))Je.call(t,e)&&he(n,e,t[e]);return n},rt=(n,t)=>ei(n,ni(t));var le=(n,t)=>{var e={};for(var i in n)Qe.call(n,i)&&t.indexOf(i)<0&&(e[i]=n[i]);if(n!=null&&zt)for(var i of zt(n))t.indexOf(i)<0&&Je.call(n,i)&&(e[i]=n[i]);return e};var g=(n,t,e)=>he(n,typeof t!="symbol"?t+"":t,e),ue=(n,t,e)=>t.has(n)||ce("Cannot "+e);var C=(n,t,e)=>(ue(n,t,"read from private field"),e?e.call(n):t.get(n)),$=(n,t,e)=>t.has(n)?ce("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(n):t.set(n,e),j=(n,t,e,i)=>(ue(n,t,"write to private field"),i?i.call(n,e):t.set(n,e),e),de=(n,t,e)=>(ue(n,t,"access private method"),e);var R=(n,t,e)=>new Promise((i,r)=>{var a=s=>{try{h(e.next(s))}catch(l){r(l)}},o=s=>{try{h(e.throw(s))}catch(l){r(l)}},h=s=>s.done?i(s.value):Promise.resolve(s.value).then(a,o);h((e=e.apply(n,t)).next())}),ii=function(n,t){this[0]=n,this[1]=t};var tn=n=>{var t=n[xt("asyncIterator")],e=!1,i,r={};return t==null?(t=n[xt("iterator")](),i=a=>r[a]=o=>t[a](o)):(t=t.call(n),i=a=>r[a]=o=>{if(e){if(e=!1,a==="throw")throw o;return o}return e=!0,{done:!1,value:new ii(new Promise(h=>{var s=t[a](o);s instanceof Object||ce("Object expected"),h(s)}),1)}}),r[xt("iterator")]=()=>r,i("next"),"throw"in t?i("throw"):r.throw=a=>{throw a},"return"in t&&i("return"),r},en=(n,t,e)=>(t=n[xt("asyncIterator")])?t.call(n):(n=n[xt("iterator")](),t={},e=(i,r)=>(r=n[i])&&(t[i]=a=>new Promise((o,h,s)=>(a=r.call(n,a),s=a.done,Promise.resolve(a.value).then(l=>o({value:l,done:s}),h)))),e("next"),e("return"),t);function ri(n,t){for(var e=0;e<t.length;e++){const i=t[e];if(typeof i!="string"&&!Array.isArray(i)){for(const r in i)if(r!=="default"&&!(r in n)){const a=Object.getOwnPropertyDescriptor(i,r);a&&Object.defineProperty(n,r,a.get?a:{enumerable:!0,get:()=>i[r]})}}}return Object.freeze(Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}))}var ct=256,Xt=[],Gt;for(;ct--;)Xt[ct]=(ct+256).toString(16).substring(1);function Zr(){var n=0,t,e="";if(!Gt||ct+16>256){for(Gt=Array(n=256);n--;)Gt[n]=256*Math.random()|0;n=ct=0}for(;n<16;n++)t=Gt[ct+n],n==6?e+=Xt[t&15|64]:n==8?e+=Xt[t&63|128]:e+=Xt[t],n&1&&n>1&&n<11&&(e+="-");return ct++,e}function Un(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}function si(n){if(Object.prototype.hasOwnProperty.call(n,"__esModule"))return n;var t=n.default;if(typeof t=="function"){var e=function i(){var r=!1;try{r=this instanceof i}catch(a){}return r?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};e.prototype=t.prototype}else e={};return Object.defineProperty(e,"__esModule",{value:!0}),Object.keys(n).forEach(function(i){var r=Object.getOwnPropertyDescriptor(n,i);Object.defineProperty(e,i,r.get?r:{enumerable:!0,get:function(){return n[i]}})}),e}var ge,nn;function oi(){return nn||(nn=1,ge=function(t,e){var i=t.length;if(t===e)return!0;if(i!==e.length)return!1;for(var r=0;r<i;r++)if(t[r]!==e[r])return!1;return!0}),ge}var ai=oi();const $r=Un(ai),kn=-1,re=0,te=1,ee=2,Ce=3,Me=4,Ne=5,Ue=6,On=7,qn=8,rn=typeof self=="object"?self:globalThis,fi=(n,t)=>{const e=(r,a)=>(n.set(a,r),r),i=r=>{if(n.has(r))return n.get(r);const[a,o]=t[r];switch(a){case re:case kn:return e(o,r);case te:{const h=e([],r);for(const s of o)h.push(i(s));return h}case ee:{const h=e({},r);for(const[s,l]of o)h[i(s)]=i(l);return h}case Ce:return e(new Date(o),r);case Me:{const{source:h,flags:s}=o;return e(new RegExp(h,s),r)}case Ne:{const h=e(new Map,r);for(const[s,l]of o)h.set(i(s),i(l));return h}case Ue:{const h=e(new Set,r);for(const s of o)h.add(i(s));return h}case On:{const{name:h,message:s}=o;return e(new rn[h](s),r)}case qn:return e(BigInt(o),r);case"BigInt":return e(Object(BigInt(o)),r)}return e(new rn[a](o),r)};return i},Vr=n=>fi(new Map,n)(0),gt="",{toString:hi}={},{keys:ci}=Object,bt=n=>{const t=typeof n;if(t!=="object"||!n)return[re,t];const e=hi.call(n).slice(8,-1);switch(e){case"Array":return[te,gt];case"Object":return[ee,gt];case"Date":return[Ce,gt];case"RegExp":return[Me,gt];case"Map":return[Ne,gt];case"Set":return[Ue,gt]}return e.includes("Array")?[te,e]:e.includes("Error")?[On,e]:[ee,e]},jt=([n,t])=>n===re&&(t==="function"||t==="symbol"),li=(n,t,e,i)=>{const r=(o,h)=>{const s=i.push(o)-1;return e.set(h,s),s},a=o=>{if(e.has(o))return e.get(o);let[h,s]=bt(o);switch(h){case re:{let u=o;switch(s){case"bigint":h=qn,u=o.toString();break;case"function":case"symbol":if(n)throw new TypeError("unable to serialize "+s);u=null;break;case"undefined":return r([kn],o)}return r([h,u],o)}case te:{if(s)return r([s,[...o]],o);const u=[],f=r([h,u],o);for(const d of o)u.push(a(d));return f}case ee:{if(s)switch(s){case"BigInt":return r([s,o.toString()],o);case"Boolean":case"Number":case"String":return r([s,o.valueOf()],o)}if(t&&"toJSON"in o)return a(o.toJSON());const u=[],f=r([h,u],o);for(const d of ci(o))(n||!jt(bt(o[d])))&&u.push([a(d),a(o[d])]);return f}case Ce:return r([h,o.toISOString()],o);case Me:{const{source:u,flags:f}=o;return r([h,{source:u,flags:f}],o)}case Ne:{const u=[],f=r([h,u],o);for(const[d,_]of o)(n||!(jt(bt(d))||jt(bt(_))))&&u.push([a(d),a(_)]);return f}case Ue:{const u=[],f=r([h,u],o);for(const d of o)(n||!jt(bt(d)))&&u.push(a(d));return f}}const{message:l}=o;return r([h,{name:s,message:l}],o)};return a},Hr=(n,{json:t,lossy:e}={})=>{const i=[];return li(!(t||e),!!t,new Map,i)(n),i};var H=Uint8Array,_t=Uint16Array,ui=Int32Array,Dn=new H([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),Bn=new H([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),di=new H([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Pn=function(n,t){for(var e=new _t(31),i=0;i<31;++i)e[i]=t+=1<<n[i-1];for(var r=new ui(e[30]),i=1;i<30;++i)for(var a=e[i];a<e[i+1];++a)r[a]=a-e[i]<<5|i;return{b:e,r}},Rn=Pn(Dn,2),Ln=Rn.b,gi=Rn.r;Ln[28]=258,gi[258]=28;var _i=Pn(Bn,0),pi=_i.b,be=new _t(32768);for(var z=0;z<32768;++z){var ot=(z&43690)>>1|(z&21845)<<1;ot=(ot&52428)>>2|(ot&13107)<<2,ot=(ot&61680)>>4|(ot&3855)<<4,be[z]=((ot&65280)>>8|(ot&255)<<8)>>1}var At=function(n,t,e){for(var i=n.length,r=0,a=new _t(t);r<i;++r)n[r]&&++a[n[r]-1];var o=new _t(t);for(r=1;r<t;++r)o[r]=o[r-1]+a[r-1]<<1;var h;if(e){h=new _t(1<<t);var s=15-t;for(r=0;r<i;++r)if(n[r])for(var l=r<<4|n[r],u=t-n[r],f=o[n[r]-1]++<<u,d=f|(1<<u)-1;f<=d;++f)h[be[f]>>s]=l}else for(h=new _t(i),r=0;r<i;++r)n[r]&&(h[r]=be[o[n[r]-1]++]>>15-n[r]);return h},Pt=new H(288);for(var z=0;z<144;++z)Pt[z]=8;for(var z=144;z<256;++z)Pt[z]=9;for(var z=256;z<280;++z)Pt[z]=7;for(var z=280;z<288;++z)Pt[z]=8;var zn=new H(32);for(var z=0;z<32;++z)zn[z]=5;var yi=At(Pt,9,1),mi=At(zn,5,1),_e=function(n){for(var t=n[0],e=1;e<n.length;++e)n[e]>t&&(t=n[e]);return t},it=function(n,t,e){var i=t/8|0;return(n[i]|n[i+1]<<8)>>(t&7)&e},pe=function(n,t){var e=t/8|0;return(n[e]|n[e+1]<<8|n[e+2]<<16)>>(t&7)},Gn=function(n){return(n+7)/8|0},Yt=function(n,t,e){return(t==null||t<0)&&(t=0),(e==null||e>n.length)&&(e=n.length),new H(n.subarray(t,e))},Ei=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],Q=function(n,t,e){var i=new Error(t||Ei[n]);if(i.code=n,Error.captureStackTrace&&Error.captureStackTrace(i,Q),!e)throw i;return i},se=function(n,t,e,i){var r=n.length,a=0;if(!r||t.f&&!t.l)return e||new H(0);var o=!e,h=o||t.i!=2,s=t.i;o&&(e=new H(r*3));var l=function(He){var We=e.length;if(He>We){var Ke=new H(Math.max(We*2,He));Ke.set(e),e=Ke}},u=t.f||0,f=t.p||0,d=t.b||0,_=t.l,m=t.d,b=t.m,M=t.n,A=r*8;do{if(!_){u=it(n,f,1);var I=it(n,f+1,3);if(f+=3,I)if(I==1)_=yi,m=mi,b=9,M=5;else if(I==2){var L=it(n,f,31)+257,B=it(n,f+10,15)+4,N=L+it(n,f+5,31)+1;f+=14;for(var y=new H(N),p=new H(19),c=0;c<B;++c)p[di[c]]=it(n,f+c*3,7);f+=B*3;for(var w=_e(p),v=(1<<w)-1,F=At(p,w,1),c=0;c<N;){var T=F[it(n,f,v)];f+=T&15;var O=T>>4;if(O<16)y[c++]=O;else{var U=0,P=0;for(O==16?(P=3+it(n,f,3),f+=2,U=y[c-1]):O==17?(P=3+it(n,f,7),f+=3):O==18&&(P=11+it(n,f,127),f+=7);P--;)y[c++]=U}}var G=y.subarray(0,L),q=y.subarray(L);b=_e(G),M=_e(q),_=At(G,b,1),m=At(q,M,1)}else Q(1);else{var O=Gn(f)+4,S=n[O-4]|n[O-3]<<8,k=O+S;if(k>r){s&&Q(0);break}h&&l(d+S),e.set(n.subarray(O,k),d),t.b=d+=S,t.p=f=k*8,t.f=u;continue}if(f>A){s&&Q(0);break}}h&&l(d+131072);for(var X=(1<<b)-1,J=(1<<M)-1,Y=f;;Y=f){var U=_[pe(n,f)&X],Z=U>>4;if(f+=U&15,f>A){s&&Q(0);break}if(U||Q(2),Z<256)e[d++]=Z;else if(Z==256){Y=f,_=null;break}else{var ft=Z-254;if(Z>264){var c=Z-257,wt=Dn[c];ft=it(n,f,(1<<wt)-1)+Ln[c],f+=wt}var ae=m[pe(n,f)&J],fe=ae>>4;ae||Q(3),f+=ae&15;var q=pi[fe];if(fe>3){var wt=Bn[fe];q+=pe(n,f)&(1<<wt)-1,f+=wt}if(f>A){s&&Q(0);break}h&&l(d+131072);var $e=d+ft;if(d<q){var Ve=a-q,Jn=Math.min(q,$e);for(Ve+d<0&&Q(3);d<Jn;++d)e[d]=i[Ve+d]}for(;d<$e;++d)e[d]=e[d-q]}}t.l=_,t.p=Y,t.b=d,t.f=u,_&&(u=1,t.m=b,t.d=m,t.n=M)}while(!u);return d!=e.length&&o?Yt(e,0,d):e.subarray(0,d)},wi=new H(0),jn=function(n){(n[0]!=31||n[1]!=139||n[2]!=8)&&Q(6,"invalid gzip data");var t=n[3],e=10;t&4&&(e+=(n[10]|n[11]<<8)+2);for(var i=(t>>3&1)+(t>>4&1);i>0;i-=!n[e++]);return e+(t&2)},xi=function(n){var t=n.length;return(n[t-4]|n[t-3]<<8|n[t-2]<<16|n[t-1]<<24)>>>0},bi=function(n,t){return((n[0]&15)!=8||n[0]>>4>7||(n[0]<<8|n[1])%31)&&Q(6,"invalid zlib data"),(n[1]>>5&1)==1&&Q(6,"invalid zlib data: "+(n[1]&32?"need":"unexpected")+" dictionary"),(n[1]>>3&4)+2},ye=function(){function n(t,e){typeof t=="function"&&(e=t,t={}),this.ondata=e;var i=t&&t.dictionary&&t.dictionary.subarray(-32768);this.s={i:0,b:i?i.length:0},this.o=new H(32768),this.p=new H(0),i&&this.o.set(i)}return n.prototype.e=function(t){if(this.ondata||Q(5),this.d&&Q(4),!this.p.length)this.p=t;else if(t.length){var e=new H(this.p.length+t.length);e.set(this.p),e.set(t,this.p.length),this.p=e}},n.prototype.c=function(t){this.s.i=+(this.d=t||!1);var e=this.s.b,i=se(this.p,this.s,this.o);this.ondata(Yt(i,e,this.s.b),this.d),this.o=Yt(i,this.s.b-32768),this.s.b=this.o.length,this.p=Yt(this.p,this.s.p/8|0),this.s.p&=7},n.prototype.push=function(t,e){this.e(t),this.c(e)},n}();function vi(n,t){return se(n,{i:2},t,t)}var Wr=function(){function n(t,e){this.v=1,this.r=0,ye.call(this,t,e)}return n.prototype.push=function(t,e){if(ye.prototype.e.call(this,t),this.r+=t.length,this.v){var i=this.p.subarray(this.v-1),r=i.length>3?jn(i):4;if(r>i.length){if(!e)return}else this.v>1&&this.onmember&&this.onmember(this.r-i.length);this.p=i.subarray(r),this.v=0}ye.prototype.c.call(this,e),this.s.f&&!this.s.l&&!e&&(this.v=Gn(this.s.p)+9,this.s={i:0},this.o=new H(0),this.push(new H(0),e))},n}();function Ai(n,t){var e=jn(n);return e+8>n.length&&Q(6,"invalid gzip data"),se(n.subarray(e,-8),{i:2},new H(xi(n)),t)}function Si(n,t){return se(n.subarray(bi(n),-4),{i:2},t,t)}function Ii(n,t){return n[0]==31&&n[1]==139&&n[2]==8?Ai(n,t):(n[0]&15)!=8||n[0]>>4>7||(n[0]<<8|n[1])%31?vi(n,t):Si(n,t)}var Fi=typeof TextDecoder!="undefined"&&new TextDecoder,Ti=0;try{Fi.decode(wi,{stream:!0}),Ti=1}catch(n){}class Ci{constructor(t,e,i,r){g(this,"esize");g(this,"ecode");g(this,"edata");g(this,"littleEndian");if(t%16!=0)throw new Error("This does not appear to be a NIFTI extension");this.esize=t,this.ecode=e,this.edata=i,this.littleEndian=r}toArrayBuffer(){let t=new Uint8Array(this.esize),e=new Uint8Array(this.edata);t.set(e,8);let i=new DataView(t.buffer);return i.setInt32(0,this.esize,this.littleEndian),i.setInt32(4,this.ecode,this.littleEndian),t.buffer}}const K=class K{static getStringAt(t,e,i){var r="",a,o;for(a=e;a<i;a+=1)o=t.getUint8(a),o!==0&&(r+=String.fromCharCode(o));return r}static getIntAt(t,e,i){return t.getInt32(e,i)}static getFloatAt(t,e,i){return t.getFloat32(e,i)}static getDoubleAt(t,e,i){return t.getFloat64(e,i)}static getInt64At(t,e,i){const r=t.getUint32(e,i),a=t.getInt32(e+4,i);let o;return i?o=a*ht(2,32)+r:o=r*ht(2,32)+a,a<0&&(o+=-1*ht(2,32)*ht(2,32)),o}static getUint64At(t,e,i){const r=t.getUint32(e+(i?0:4),i),a=t.getUint32(e+(i?4:0),i);return i?a*ht(2,32)+r:r*ht(2,32)+a}static getExtensionsAt(t,e,i,r){let a=[],o=e;for(;o<r;){let h=i,s=K.getIntAt(t,o,i);if(!s)break;if(s+o>r&&(h=!h,s=K.getIntAt(t,o,h),s+o>r))throw new Error("This does not appear to be a valid NIFTI extension");if(s%16!=0)throw new Error("This does not appear to be a NIFTI extension");let l=K.getIntAt(t,o+4,h),u=t.buffer.slice(o+8,o+s),f=new Ci(s,l,u,h);a.push(f),o+=s}return a}static toArrayBuffer(t){var e,i,r;for(e=new ArrayBuffer(t.length),i=new Uint8Array(e),r=0;r<t.length;r+=1)i[r]=t[r];return e}static isString(t){return typeof t=="string"||t instanceof String}static formatNumber(t,e=void 0){let i;return K.isString(t)?i=Number(t):i=t,e?i=i.toPrecision(5):i=i.toPrecision(7),parseFloat(i)}static makeCRCTable(){let t,e=[];for(var i=0;i<256;i++){t=i;for(var r=0;r<8;r++)t=t&1?3988292384^t>>>1:t>>>1;e[i]=t}return e}static crc32(t){K.crcTable||(K.crcTable=K.makeCRCTable());const e=K.crcTable;let i=-1;for(var r=0;r<t.byteLength;r++)i=i>>>8^e[(i^t.getUint8(r))&255];return(i^-1)>>>0}};g(K,"crcTable",null),g(K,"GUNZIP_MAGIC_COOKIE1",31),g(K,"GUNZIP_MAGIC_COOKIE2",139),g(K,"getByteAt",function(t,e){return t.getUint8(e)}),g(K,"getShortAt",function(t,e,i){return t.getInt16(e,i)});let E=K;const x=class x{constructor(){g(this,"littleEndian",!1);g(this,"dim_info",0);g(this,"dims",[]);g(this,"intent_p1",0);g(this,"intent_p2",0);g(this,"intent_p3",0);g(this,"intent_code",0);g(this,"datatypeCode",0);g(this,"numBitsPerVoxel",0);g(this,"slice_start",0);g(this,"slice_end",0);g(this,"slice_code",0);g(this,"pixDims",[]);g(this,"vox_offset",0);g(this,"scl_slope",1);g(this,"scl_inter",0);g(this,"xyzt_units",0);g(this,"cal_max",0);g(this,"cal_min",0);g(this,"slice_duration",0);g(this,"toffset",0);g(this,"description","");g(this,"aux_file","");g(this,"intent_name","");g(this,"qform_code",0);g(this,"sform_code",0);g(this,"quatern_a",0);g(this,"quatern_b",0);g(this,"quatern_c",0);g(this,"quatern_d",0);g(this,"qoffset_x",0);g(this,"qoffset_y",0);g(this,"qoffset_z",0);g(this,"affine",[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]]);g(this,"qfac",1);g(this,"quatern_R");g(this,"magic","0");g(this,"isHDR",!1);g(this,"extensionFlag",[0,0,0,0]);g(this,"extensionSize",0);g(this,"extensionCode",0);g(this,"extensions",[]);g(this,"getDatatypeCodeString",function(t){return t===x.TYPE_UINT8?"1-Byte Unsigned Integer":t===x.TYPE_INT16?"2-Byte Signed Integer":t===x.TYPE_INT32?"4-Byte Signed Integer":t===x.TYPE_FLOAT32?"4-Byte Float":t===x.TYPE_FLOAT64?"8-Byte Float":t===x.TYPE_RGB24?"RGB":t===x.TYPE_INT8?"1-Byte Signed Integer":t===x.TYPE_UINT16?"2-Byte Unsigned Integer":t===x.TYPE_UINT32?"4-Byte Unsigned Integer":t===x.TYPE_INT64?"8-Byte Signed Integer":t===x.TYPE_UINT64?"8-Byte Unsigned Integer":"Unknown"});g(this,"getTransformCodeString",function(t){return t===x.XFORM_SCANNER_ANAT?"Scanner":t===x.XFORM_ALIGNED_ANAT?"Aligned":t===x.XFORM_TALAIRACH?"Talairach":t===x.XFORM_MNI_152?"MNI":"Unknown"});g(this,"getUnitsCodeString",function(t){return t===x.UNITS_METER?"Meters":t===x.UNITS_MM?"Millimeters":t===x.UNITS_MICRON?"Microns":t===x.UNITS_SEC?"Seconds":t===x.UNITS_MSEC?"Milliseconds":t===x.UNITS_USEC?"Microseconds":t===x.UNITS_HZ?"Hz":t===x.UNITS_PPM?"PPM":t===x.UNITS_RADS?"Rads":"Unknown"});g(this,"nifti_mat33_mul",function(t,e){var i=[[0,0,0],[0,0,0],[0,0,0]],r,a;for(r=0;r<3;r+=1)for(a=0;a<3;a+=1)i[r][a]=t[r][0]*e[0][a]+t[r][1]*e[1][a]+t[r][2]*e[2][a];return i});g(this,"nifti_mat33_determ",function(t){var e,i,r,a,o,h,s,l,u;return e=t[0][0],i=t[0][1],r=t[0][2],a=t[1][0],o=t[1][1],h=t[1][2],s=t[2][0],l=t[2][1],u=t[2][2],e*o*u-e*l*h-a*i*u+a*l*r+s*i*h-s*o*r})}readHeader(t){var e=new DataView(t),i=E.getIntAt(e,0,this.littleEndian),r,a,o,h;if(i!==x.MAGIC_COOKIE&&(this.littleEndian=!0,i=E.getIntAt(e,0,this.littleEndian)),i!==x.MAGIC_COOKIE)throw new Error("This does not appear to be a NIFTI file!");for(this.dim_info=E.getByteAt(e,39),r=0;r<8;r+=1)h=40+r*2,this.dims[r]=E.getShortAt(e,h,this.littleEndian);for(this.intent_p1=E.getFloatAt(e,56,this.littleEndian),this.intent_p2=E.getFloatAt(e,60,this.littleEndian),this.intent_p3=E.getFloatAt(e,64,this.littleEndian),this.intent_code=E.getShortAt(e,68,this.littleEndian),this.datatypeCode=E.getShortAt(e,70,this.littleEndian),this.numBitsPerVoxel=E.getShortAt(e,72,this.littleEndian),this.slice_start=E.getShortAt(e,74,this.littleEndian),r=0;r<8;r+=1)h=76+r*4,this.pixDims[r]=E.getFloatAt(e,h,this.littleEndian);if(this.vox_offset=E.getFloatAt(e,108,this.littleEndian),this.scl_slope=E.getFloatAt(e,112,this.littleEndian),this.scl_inter=E.getFloatAt(e,116,this.littleEndian),this.slice_end=E.getShortAt(e,120,this.littleEndian),this.slice_code=E.getByteAt(e,122),this.xyzt_units=E.getByteAt(e,123),this.cal_max=E.getFloatAt(e,124,this.littleEndian),this.cal_min=E.getFloatAt(e,128,this.littleEndian),this.slice_duration=E.getFloatAt(e,132,this.littleEndian),this.toffset=E.getFloatAt(e,136,this.littleEndian),this.description=E.getStringAt(e,148,228),this.aux_file=E.getStringAt(e,228,252),this.qform_code=E.getShortAt(e,252,this.littleEndian),this.sform_code=E.getShortAt(e,254,this.littleEndian),this.quatern_b=E.getFloatAt(e,256,this.littleEndian),this.quatern_c=E.getFloatAt(e,260,this.littleEndian),this.quatern_d=E.getFloatAt(e,264,this.littleEndian),this.quatern_a=Math.sqrt(1-(Math.pow(this.quatern_b,2)+Math.pow(this.quatern_c,2)+Math.pow(this.quatern_d,2))),this.qoffset_x=E.getFloatAt(e,268,this.littleEndian),this.qoffset_y=E.getFloatAt(e,272,this.littleEndian),this.qoffset_z=E.getFloatAt(e,276,this.littleEndian),this.qform_code<1&&this.sform_code<1&&(this.affine[0][0]=this.pixDims[1],this.affine[1][1]=this.pixDims[2],this.affine[2][2]=this.pixDims[3]),this.qform_code>0&&this.sform_code<this.qform_code){const s=this.quatern_a,l=this.quatern_b,u=this.quatern_c,f=this.quatern_d;for(this.qfac=this.pixDims[0]===0?1:this.pixDims[0],this.quatern_R=[[s*s+l*l-u*u-f*f,2*l*u-2*s*f,2*l*f+2*s*u],[2*l*u+2*s*f,s*s+u*u-l*l-f*f,2*u*f-2*s*l],[2*l*f-2*s*u,2*u*f+2*s*l,s*s+f*f-u*u-l*l]],a=0;a<3;a+=1)for(o=0;o<3;o+=1)this.affine[a][o]=this.quatern_R[a][o]*this.pixDims[o+1],o===2&&(this.affine[a][o]*=this.qfac);this.affine[0][3]=this.qoffset_x,this.affine[1][3]=this.qoffset_y,this.affine[2][3]=this.qoffset_z}else if(this.sform_code>0)for(a=0;a<3;a+=1)for(o=0;o<4;o+=1)h=280+(a*4+o)*4,this.affine[a][o]=E.getFloatAt(e,h,this.littleEndian);if(this.affine[3][0]=0,this.affine[3][1]=0,this.affine[3][2]=0,this.affine[3][3]=1,this.intent_name=E.getStringAt(e,328,344),this.magic=E.getStringAt(e,344,348),this.isHDR=this.magic===String.fromCharCode.apply(null,x.MAGIC_NUMBER2),e.byteLength>x.MAGIC_COOKIE){this.extensionFlag[0]=E.getByteAt(e,348),this.extensionFlag[1]=E.getByteAt(e,349),this.extensionFlag[2]=E.getByteAt(e,350),this.extensionFlag[3]=E.getByteAt(e,351);let s=!0;!this.isHDR&&this.vox_offset<=352&&(s=!1),e.byteLength<=368&&(s=!1),s&&this.extensionFlag[0]&&(this.extensions=E.getExtensionsAt(e,this.getExtensionLocation(),this.littleEndian,this.vox_offset),this.extensionSize=this.extensions[0].esize,this.extensionCode=this.extensions[0].ecode)}}toFormattedString(){var t=E.formatNumber,e="";return e+="Dim Info = "+this.dim_info+`
`,e+="Image Dimensions (1-8): "+this.dims[0]+", "+this.dims[1]+", "+this.dims[2]+", "+this.dims[3]+", "+this.dims[4]+", "+this.dims[5]+", "+this.dims[6]+", "+this.dims[7]+`
`,e+="Intent Parameters (1-3): "+this.intent_p1+", "+this.intent_p2+", "+this.intent_p3+`
`,e+="Intent Code = "+this.intent_code+`
`,e+="Datatype = "+this.datatypeCode+" ("+this.getDatatypeCodeString(this.datatypeCode)+`)
`,e+="Bits Per Voxel = "+this.numBitsPerVoxel+`
`,e+="Slice Start = "+this.slice_start+`
`,e+="Voxel Dimensions (1-8): "+t(this.pixDims[0])+", "+t(this.pixDims[1])+", "+t(this.pixDims[2])+", "+t(this.pixDims[3])+", "+t(this.pixDims[4])+", "+t(this.pixDims[5])+", "+t(this.pixDims[6])+", "+t(this.pixDims[7])+`
`,e+="Image Offset = "+this.vox_offset+`
`,e+="Data Scale:  Slope = "+t(this.scl_slope)+"  Intercept = "+t(this.scl_inter)+`
`,e+="Slice End = "+this.slice_end+`
`,e+="Slice Code = "+this.slice_code+`
`,e+="Units Code = "+this.xyzt_units+" ("+this.getUnitsCodeString(x.SPATIAL_UNITS_MASK&this.xyzt_units)+", "+this.getUnitsCodeString(x.TEMPORAL_UNITS_MASK&this.xyzt_units)+`)
`,e+="Display Range:  Max = "+t(this.cal_max)+"  Min = "+t(this.cal_min)+`
`,e+="Slice Duration = "+this.slice_duration+`
`,e+="Time Axis Shift = "+this.toffset+`
`,e+='Description: "'+this.description+`"
`,e+='Auxiliary File: "'+this.aux_file+`"
`,e+="Q-Form Code = "+this.qform_code+" ("+this.getTransformCodeString(this.qform_code)+`)
`,e+="S-Form Code = "+this.sform_code+" ("+this.getTransformCodeString(this.sform_code)+`)
`,e+="Quaternion Parameters:  b = "+t(this.quatern_b)+"  c = "+t(this.quatern_c)+"  d = "+t(this.quatern_d)+`
`,e+="Quaternion Offsets:  x = "+this.qoffset_x+"  y = "+this.qoffset_y+"  z = "+this.qoffset_z+`
`,e+="S-Form Parameters X: "+t(this.affine[0][0])+", "+t(this.affine[0][1])+", "+t(this.affine[0][2])+", "+t(this.affine[0][3])+`
`,e+="S-Form Parameters Y: "+t(this.affine[1][0])+", "+t(this.affine[1][1])+", "+t(this.affine[1][2])+", "+t(this.affine[1][3])+`
`,e+="S-Form Parameters Z: "+t(this.affine[2][0])+", "+t(this.affine[2][1])+", "+t(this.affine[2][2])+", "+t(this.affine[2][3])+`
`,e+='Intent Name: "'+this.intent_name+`"
`,this.extensionFlag[0]&&(e+="Extension: Size = "+this.extensionSize+"  Code = "+this.extensionCode+`
`),e}getQformMat(){return this.convertNiftiQFormToNiftiSForm(this.quatern_b,this.quatern_c,this.quatern_d,this.qoffset_x,this.qoffset_y,this.qoffset_z,this.pixDims[1],this.pixDims[2],this.pixDims[3],this.pixDims[0])}convertNiftiQFormToNiftiSForm(t,e,i,r,a,o,h,s,l,u){var f=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],d,_=t,m=e,b=i,M,A,I;return f[3][0]=f[3][1]=f[3][2]=0,f[3][3]=1,d=1-(_*_+m*m+b*b),d<1e-7?(d=1/Math.sqrt(_*_+m*m+b*b),_*=d,m*=d,b*=d,d=0):d=Math.sqrt(d),M=h>0?h:1,A=s>0?s:1,I=l>0?l:1,u<0&&(I=-I),f[0][0]=(d*d+_*_-m*m-b*b)*M,f[0][1]=2*(_*m-d*b)*A,f[0][2]=2*(_*b+d*m)*I,f[1][0]=2*(_*m+d*b)*M,f[1][1]=(d*d+m*m-_*_-b*b)*A,f[1][2]=2*(m*b-d*_)*I,f[2][0]=2*(_*b-d*m)*M,f[2][1]=2*(m*b+d*_)*A,f[2][2]=(d*d+b*b-m*m-_*_)*I,f[0][3]=r,f[1][3]=a,f[2][3]=o,f}convertNiftiSFormToNEMA(t){var e,i,r,a,o,h,s,l,u,f,d,_,m,b,M,A,I,O,S,k,L,B,N,y,p,c,w,v,F,T,U,P,G,q;if(M=0,w=[[0,0,0],[0,0,0],[0,0,0]],v=[[0,0,0],[0,0,0],[0,0,0]],e=t[0][0],i=t[0][1],r=t[0][2],a=t[1][0],o=t[1][1],h=t[1][2],s=t[2][0],l=t[2][1],u=t[2][2],f=Math.sqrt(e*e+a*a+s*s),f===0||(e/=f,a/=f,s/=f,f=Math.sqrt(i*i+o*o+l*l),f===0))return null;if(i/=f,o/=f,l/=f,f=e*i+a*o+s*l,Math.abs(f)>1e-4){if(i-=f*e,o-=f*a,l-=f*s,f=Math.sqrt(i*i+o*o+l*l),f===0)return null;i/=f,o/=f,l/=f}if(f=Math.sqrt(r*r+h*h+u*u),f===0?(r=a*l-s*o,h=s*i-l*e,u=e*o-a*i):(r/=f,h/=f,u/=f),f=e*r+a*h+s*u,Math.abs(f)>1e-4){if(r-=f*e,h-=f*a,u-=f*s,f=Math.sqrt(r*r+h*h+u*u),f===0)return null;r/=f,h/=f,u/=f}if(f=i*r+o*h+l*u,Math.abs(f)>1e-4){if(r-=f*i,h-=f*o,u-=f*l,f=Math.sqrt(r*r+h*h+u*u),f===0)return null;r/=f,h/=f,u/=f}if(w[0][0]=e,w[0][1]=i,w[0][2]=r,w[1][0]=a,w[1][1]=o,w[1][2]=h,w[2][0]=s,w[2][1]=l,w[2][2]=u,d=this.nifti_mat33_determ(w),d===0)return null;for(c=-666,S=B=N=y=1,k=2,L=3,m=1;m<=3;m+=1)for(b=1;b<=3;b+=1)if(m!==b){for(M=1;M<=3;M+=1)if(!(m===M||b===M))for(v[0][0]=v[0][1]=v[0][2]=v[1][0]=v[1][1]=v[1][2]=v[2][0]=v[2][1]=v[2][2]=0,A=-1;A<=1;A+=2)for(I=-1;I<=1;I+=2)for(O=-1;O<=1;O+=2)v[0][m-1]=A,v[1][b-1]=I,v[2][M-1]=O,_=this.nifti_mat33_determ(v),_*d>0&&(p=this.nifti_mat33_mul(v,w),f=p[0][0]+p[1][1]+p[2][2],f>c&&(c=f,S=m,k=b,L=M,B=A,N=I,y=O))}switch(F=T=U=P=G=q="",S*B){case 1:F="X",P="+";break;case-1:F="X",P="-";break;case 2:F="Y",P="+";break;case-2:F="Y",P="-";break;case 3:F="Z",P="+";break;case-3:F="Z",P="-";break}switch(k*N){case 1:T="X",G="+";break;case-1:T="X",G="-";break;case 2:T="Y",G="+";break;case-2:T="Y",G="-";break;case 3:T="Z",G="+";break;case-3:T="Z",G="-";break}switch(L*y){case 1:U="X",q="+";break;case-1:U="X",q="-";break;case 2:U="Y",q="+";break;case-2:U="Y",q="-";break;case 3:U="Z",q="+";break;case-3:U="Z",q="-";break}return F+T+U+P+G+q}getExtensionLocation(){return x.MAGIC_COOKIE+4}getExtensionSize(t){return E.getIntAt(t,this.getExtensionLocation(),this.littleEndian)}getExtensionCode(t){return E.getIntAt(t,this.getExtensionLocation()+4,this.littleEndian)}addExtension(t,e=-1){e==-1?this.extensions.push(t):this.extensions.splice(e,0,t),this.vox_offset+=t.esize}removeExtension(t){let e=this.extensions[t];e&&(this.vox_offset-=e.esize),this.extensions.splice(t,1)}toArrayBuffer(t=!1){let r=352;if(t)for(let s of this.extensions)r+=s.esize;let a=new Uint8Array(r),o=new DataView(a.buffer);o.setInt32(0,348,this.littleEndian),o.setUint8(39,this.dim_info);for(let s=0;s<8;s++)o.setUint16(40+2*s,this.dims[s],this.littleEndian);o.setFloat32(56,this.intent_p1,this.littleEndian),o.setFloat32(60,this.intent_p2,this.littleEndian),o.setFloat32(64,this.intent_p3,this.littleEndian),o.setInt16(68,this.intent_code,this.littleEndian),o.setInt16(70,this.datatypeCode,this.littleEndian),o.setInt16(72,this.numBitsPerVoxel,this.littleEndian),o.setInt16(74,this.slice_start,this.littleEndian);for(let s=0;s<8;s++)o.setFloat32(76+4*s,this.pixDims[s],this.littleEndian);o.setFloat32(108,this.vox_offset,this.littleEndian),o.setFloat32(112,this.scl_slope,this.littleEndian),o.setFloat32(116,this.scl_inter,this.littleEndian),o.setInt16(120,this.slice_end,this.littleEndian),o.setUint8(122,this.slice_code),o.setUint8(123,this.xyzt_units),o.setFloat32(124,this.cal_max,this.littleEndian),o.setFloat32(128,this.cal_min,this.littleEndian),o.setFloat32(132,this.slice_duration,this.littleEndian),o.setFloat32(136,this.toffset,this.littleEndian),a.set(new TextEncoder().encode(this.description),148),a.set(new TextEncoder().encode(this.aux_file),228),o.setInt16(252,this.qform_code,this.littleEndian),o.setInt16(254,this.sform_code,this.littleEndian),o.setFloat32(256,this.quatern_b,this.littleEndian),o.setFloat32(260,this.quatern_c,this.littleEndian),o.setFloat32(264,this.quatern_d,this.littleEndian),o.setFloat32(268,this.qoffset_x,this.littleEndian),o.setFloat32(272,this.qoffset_y,this.littleEndian),o.setFloat32(276,this.qoffset_z,this.littleEndian);const h=this.affine.flat();for(let s=0;s<12;s++)o.setFloat32(280+4*s,h[s],this.littleEndian);if(a.set(new TextEncoder().encode(this.intent_name),328),a.set(new TextEncoder().encode(this.magic),344),t){a.set(Uint8Array.from([1,0,0,0]),348);let s=this.getExtensionLocation();for(const l of this.extensions)o.setInt32(s,l.esize,l.littleEndian),o.setInt32(s+4,l.ecode,l.littleEndian),a.set(new Uint8Array(l.edata),s+8),s+=l.esize}else a.set(new Uint8Array(4).fill(0),348);return a.buffer}};g(x,"TYPE_NONE",0),g(x,"TYPE_BINARY",1),g(x,"TYPE_UINT8",2),g(x,"TYPE_INT16",4),g(x,"TYPE_INT32",8),g(x,"TYPE_FLOAT32",16),g(x,"TYPE_COMPLEX64",32),g(x,"TYPE_FLOAT64",64),g(x,"TYPE_RGB24",128),g(x,"TYPE_INT8",256),g(x,"TYPE_UINT16",512),g(x,"TYPE_UINT32",768),g(x,"TYPE_INT64",1024),g(x,"TYPE_UINT64",1280),g(x,"TYPE_FLOAT128",1536),g(x,"TYPE_COMPLEX128",1792),g(x,"TYPE_COMPLEX256",2048),g(x,"XFORM_UNKNOWN",0),g(x,"XFORM_SCANNER_ANAT",1),g(x,"XFORM_ALIGNED_ANAT",2),g(x,"XFORM_TALAIRACH",3),g(x,"XFORM_MNI_152",4),g(x,"SPATIAL_UNITS_MASK",7),g(x,"TEMPORAL_UNITS_MASK",56),g(x,"UNITS_UNKNOWN",0),g(x,"UNITS_METER",1),g(x,"UNITS_MM",2),g(x,"UNITS_MICRON",3),g(x,"UNITS_SEC",8),g(x,"UNITS_MSEC",16),g(x,"UNITS_USEC",24),g(x,"UNITS_HZ",32),g(x,"UNITS_PPM",40),g(x,"UNITS_RADS",48),g(x,"MAGIC_COOKIE",348),g(x,"STANDARD_HEADER_SIZE",348),g(x,"MAGIC_NUMBER_LOCATION",344),g(x,"MAGIC_NUMBER",[110,43,49]),g(x,"MAGIC_NUMBER2",[110,105,49]),g(x,"EXTENSION_HEADER_SIZE",8);let D=x;const st=class st{constructor(){g(this,"littleEndian",!1);g(this,"dim_info",0);g(this,"dims",[]);g(this,"intent_p1",0);g(this,"intent_p2",0);g(this,"intent_p3",0);g(this,"intent_code",0);g(this,"datatypeCode",0);g(this,"numBitsPerVoxel",0);g(this,"slice_start",0);g(this,"slice_end",0);g(this,"slice_code",0);g(this,"pixDims",[]);g(this,"vox_offset",0);g(this,"scl_slope",1);g(this,"scl_inter",0);g(this,"xyzt_units",0);g(this,"cal_max",0);g(this,"cal_min",0);g(this,"slice_duration",0);g(this,"toffset",0);g(this,"description","");g(this,"aux_file","");g(this,"intent_name","");g(this,"qform_code",0);g(this,"sform_code",0);g(this,"quatern_b",0);g(this,"quatern_c",0);g(this,"quatern_d",0);g(this,"qoffset_x",0);g(this,"qoffset_y",0);g(this,"qoffset_z",0);g(this,"affine",[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]]);g(this,"magic","0");g(this,"extensionFlag",[0,0,0,0]);g(this,"extensions",[]);g(this,"extensionSize",0);g(this,"extensionCode",0);g(this,"getExtensionLocation",function(){return st.MAGIC_COOKIE+4});g(this,"getExtensionSize",D.prototype.getExtensionSize);g(this,"getExtensionCode",D.prototype.getExtensionCode);g(this,"addExtension",D.prototype.addExtension);g(this,"removeExtension",D.prototype.removeExtension);g(this,"getDatatypeCodeString",D.prototype.getDatatypeCodeString);g(this,"getTransformCodeString",D.prototype.getTransformCodeString);g(this,"getUnitsCodeString",D.prototype.getUnitsCodeString);g(this,"getQformMat",D.prototype.getQformMat);g(this,"convertNiftiQFormToNiftiSForm",D.prototype.convertNiftiQFormToNiftiSForm);g(this,"convertNiftiSFormToNEMA",D.prototype.convertNiftiSFormToNEMA);g(this,"nifti_mat33_mul",D.prototype.nifti_mat33_mul);g(this,"nifti_mat33_determ",D.prototype.nifti_mat33_determ)}readHeader(t){var e=new DataView(t),i=E.getIntAt(e,0,this.littleEndian),r,a,o,h;if(i!==st.MAGIC_COOKIE&&(this.littleEndian=!0,i=E.getIntAt(e,0,this.littleEndian)),i!==st.MAGIC_COOKIE)throw new Error("This does not appear to be a NIFTI file!");for(this.magic=E.getStringAt(e,4,12),this.datatypeCode=E.getShortAt(e,12,this.littleEndian),this.numBitsPerVoxel=E.getShortAt(e,14,this.littleEndian),r=0;r<8;r+=1)h=16+r*8,this.dims[r]=E.getInt64At(e,h,this.littleEndian);for(this.intent_p1=E.getDoubleAt(e,80,this.littleEndian),this.intent_p2=E.getDoubleAt(e,88,this.littleEndian),this.intent_p3=E.getDoubleAt(e,96,this.littleEndian),r=0;r<8;r+=1)h=104+r*8,this.pixDims[r]=E.getDoubleAt(e,h,this.littleEndian);for(this.vox_offset=E.getInt64At(e,168,this.littleEndian),this.scl_slope=E.getDoubleAt(e,176,this.littleEndian),this.scl_inter=E.getDoubleAt(e,184,this.littleEndian),this.cal_max=E.getDoubleAt(e,192,this.littleEndian),this.cal_min=E.getDoubleAt(e,200,this.littleEndian),this.slice_duration=E.getDoubleAt(e,208,this.littleEndian),this.toffset=E.getDoubleAt(e,216,this.littleEndian),this.slice_start=E.getInt64At(e,224,this.littleEndian),this.slice_end=E.getInt64At(e,232,this.littleEndian),this.description=E.getStringAt(e,240,320),this.aux_file=E.getStringAt(e,320,344),this.qform_code=E.getIntAt(e,344,this.littleEndian),this.sform_code=E.getIntAt(e,348,this.littleEndian),this.quatern_b=E.getDoubleAt(e,352,this.littleEndian),this.quatern_c=E.getDoubleAt(e,360,this.littleEndian),this.quatern_d=E.getDoubleAt(e,368,this.littleEndian),this.qoffset_x=E.getDoubleAt(e,376,this.littleEndian),this.qoffset_y=E.getDoubleAt(e,384,this.littleEndian),this.qoffset_z=E.getDoubleAt(e,392,this.littleEndian),a=0;a<3;a+=1)for(o=0;o<4;o+=1)h=400+(a*4+o)*8,this.affine[a][o]=E.getDoubleAt(e,h,this.littleEndian);this.affine[3][0]=0,this.affine[3][1]=0,this.affine[3][2]=0,this.affine[3][3]=1,this.slice_code=E.getIntAt(e,496,this.littleEndian),this.xyzt_units=E.getIntAt(e,500,this.littleEndian),this.intent_code=E.getIntAt(e,504,this.littleEndian),this.intent_name=E.getStringAt(e,508,524),this.dim_info=E.getByteAt(e,524),e.byteLength>st.MAGIC_COOKIE&&(this.extensionFlag[0]=E.getByteAt(e,540),this.extensionFlag[1]=E.getByteAt(e,541),this.extensionFlag[2]=E.getByteAt(e,542),this.extensionFlag[3]=E.getByteAt(e,543),this.extensionFlag[0]&&(this.extensions=E.getExtensionsAt(e,this.getExtensionLocation(),this.littleEndian,this.vox_offset),this.extensionSize=this.extensions[0].esize,this.extensionCode=this.extensions[0].ecode))}toFormattedString(){var t=E.formatNumber,e="";return e+="Datatype = "+ +this.datatypeCode+" ("+this.getDatatypeCodeString(this.datatypeCode)+`)
`,e+="Bits Per Voxel =  = "+this.numBitsPerVoxel+`
`,e+="Image Dimensions (1-8): "+this.dims[0]+", "+this.dims[1]+", "+this.dims[2]+", "+this.dims[3]+", "+this.dims[4]+", "+this.dims[5]+", "+this.dims[6]+", "+this.dims[7]+`
`,e+="Intent Parameters (1-3): "+this.intent_p1+", "+this.intent_p2+", "+this.intent_p3+`
`,e+="Voxel Dimensions (1-8): "+t(this.pixDims[0])+", "+t(this.pixDims[1])+", "+t(this.pixDims[2])+", "+t(this.pixDims[3])+", "+t(this.pixDims[4])+", "+t(this.pixDims[5])+", "+t(this.pixDims[6])+", "+t(this.pixDims[7])+`
`,e+="Image Offset = "+this.vox_offset+`
`,e+="Data Scale:  Slope = "+t(this.scl_slope)+"  Intercept = "+t(this.scl_inter)+`
`,e+="Display Range:  Max = "+t(this.cal_max)+"  Min = "+t(this.cal_min)+`
`,e+="Slice Duration = "+this.slice_duration+`
`,e+="Time Axis Shift = "+this.toffset+`
`,e+="Slice Start = "+this.slice_start+`
`,e+="Slice End = "+this.slice_end+`
`,e+='Description: "'+this.description+`"
`,e+='Auxiliary File: "'+this.aux_file+`"
`,e+="Q-Form Code = "+this.qform_code+" ("+this.getTransformCodeString(this.qform_code)+`)
`,e+="S-Form Code = "+this.sform_code+" ("+this.getTransformCodeString(this.sform_code)+`)
`,e+="Quaternion Parameters:  b = "+t(this.quatern_b)+"  c = "+t(this.quatern_c)+"  d = "+t(this.quatern_d)+`
`,e+="Quaternion Offsets:  x = "+this.qoffset_x+"  y = "+this.qoffset_y+"  z = "+this.qoffset_z+`
`,e+="S-Form Parameters X: "+t(this.affine[0][0])+", "+t(this.affine[0][1])+", "+t(this.affine[0][2])+", "+t(this.affine[0][3])+`
`,e+="S-Form Parameters Y: "+t(this.affine[1][0])+", "+t(this.affine[1][1])+", "+t(this.affine[1][2])+", "+t(this.affine[1][3])+`
`,e+="S-Form Parameters Z: "+t(this.affine[2][0])+", "+t(this.affine[2][1])+", "+t(this.affine[2][2])+", "+t(this.affine[2][3])+`
`,e+="Slice Code = "+this.slice_code+`
`,e+="Units Code = "+this.xyzt_units+" ("+this.getUnitsCodeString(D.SPATIAL_UNITS_MASK&this.xyzt_units)+", "+this.getUnitsCodeString(D.TEMPORAL_UNITS_MASK&this.xyzt_units)+`)
`,e+="Intent Code = "+this.intent_code+`
`,e+='Intent Name: "'+this.intent_name+`"
`,e+="Dim Info = "+this.dim_info+`
`,e}toArrayBuffer(t=!1){let r=544;if(t)for(let s of this.extensions)r+=s.esize;let a=new Uint8Array(r),o=new DataView(a.buffer);o.setInt32(0,540,this.littleEndian),a.set(new TextEncoder().encode(this.magic),4),o.setInt16(12,this.datatypeCode,this.littleEndian),o.setInt16(14,this.numBitsPerVoxel,this.littleEndian);for(let s=0;s<8;s++)o.setBigInt64(16+8*s,BigInt(this.dims[s]),this.littleEndian);o.setFloat64(80,this.intent_p1,this.littleEndian),o.setFloat64(88,this.intent_p2,this.littleEndian),o.setFloat64(96,this.intent_p3,this.littleEndian);for(let s=0;s<8;s++)o.setFloat64(104+8*s,this.pixDims[s],this.littleEndian);o.setBigInt64(168,BigInt(this.vox_offset),this.littleEndian),o.setFloat64(176,this.scl_slope,this.littleEndian),o.setFloat64(184,this.scl_inter,this.littleEndian),o.setFloat64(192,this.cal_max,this.littleEndian),o.setFloat64(200,this.cal_min,this.littleEndian),o.setFloat64(208,this.slice_duration,this.littleEndian),o.setFloat64(216,this.toffset,this.littleEndian),o.setBigInt64(224,BigInt(this.slice_start),this.littleEndian),o.setBigInt64(232,BigInt(this.slice_end),this.littleEndian),a.set(new TextEncoder().encode(this.description),240),a.set(new TextEncoder().encode(this.aux_file),320),o.setInt32(344,this.qform_code,this.littleEndian),o.setInt32(348,this.sform_code,this.littleEndian),o.setFloat64(352,this.quatern_b,this.littleEndian),o.setFloat64(360,this.quatern_c,this.littleEndian),o.setFloat64(368,this.quatern_d,this.littleEndian),o.setFloat64(376,this.qoffset_x,this.littleEndian),o.setFloat64(384,this.qoffset_y,this.littleEndian),o.setFloat64(392,this.qoffset_z,this.littleEndian);const h=this.affine.flat();for(let s=0;s<12;s++)o.setFloat64(400+8*s,h[s],this.littleEndian);if(o.setInt32(496,this.slice_code,this.littleEndian),o.setInt32(500,this.xyzt_units,this.littleEndian),o.setInt32(504,this.intent_code,this.littleEndian),a.set(new TextEncoder().encode(this.intent_name),508),o.setUint8(524,this.dim_info),t){a.set(Uint8Array.from([1,0,0,0]),540);let s=this.getExtensionLocation();for(const l of this.extensions)o.setInt32(s,l.esize,l.littleEndian),o.setInt32(s+4,l.ecode,l.littleEndian),a.set(new Uint8Array(l.edata),s+8),s+=l.esize}else a.set(new Uint8Array(4).fill(0),540);return a.buffer}};g(st,"MAGIC_COOKIE",540),g(st,"MAGIC_NUMBER_LOCATION",4),g(st,"MAGIC_NUMBER",[110,43,50,0,13,10,26,10]),g(st,"MAGIC_NUMBER2",[110,105,50,0,13,10,26,10]);let tt=st;function Mi(n,t=!1){var e,i,r,a;return n.byteLength<D.STANDARD_HEADER_SIZE?!1:(e=new DataView(n),e&&(i=e.getUint8(D.MAGIC_NUMBER_LOCATION)),r=e.getUint8(D.MAGIC_NUMBER_LOCATION+1),a=e.getUint8(D.MAGIC_NUMBER_LOCATION+2),t&&i===D.MAGIC_NUMBER2[0]&&r===D.MAGIC_NUMBER2[1]&&a===D.MAGIC_NUMBER2[2]?!0:i===D.MAGIC_NUMBER[0]&&r===D.MAGIC_NUMBER[1]&&a===D.MAGIC_NUMBER[2])}function Ni(n,t=!1){var e,i,r,a;return n.byteLength<D.STANDARD_HEADER_SIZE?!1:(e=new DataView(n),i=e.getUint8(tt.MAGIC_NUMBER_LOCATION),r=e.getUint8(tt.MAGIC_NUMBER_LOCATION+1),a=e.getUint8(tt.MAGIC_NUMBER_LOCATION+2),t&&i===tt.MAGIC_NUMBER2[0]&&r===tt.MAGIC_NUMBER2[1]&&a===tt.MAGIC_NUMBER2[2]?!0:i===tt.MAGIC_NUMBER[0]&&r===tt.MAGIC_NUMBER[1]&&a===tt.MAGIC_NUMBER[2])}function Xn(n){var t,e,i;return!!(n&&(t=new DataView(n),e=t.getUint8(0),i=t.getUint8(1),e===E.GUNZIP_MAGIC_COOKIE1||i===E.GUNZIP_MAGIC_COOKIE2))}function Ui(n){return Ii(new Uint8Array(n)).buffer}function Kr(n){return R(this,null,function*(){const t=new Uint8Array(n),e=t[0]===31&&t[1]===139&&t[2]===8?"gzip":t[0]===120&&(t[1]===1||t[1]===94||t[1]===156||t[1]===218)?"deflate":"deflate-raw",i=new DecompressionStream(e),r=i.writable.getWriter();r.write(t).catch(console.error);const a=r.close().catch(console.error),h=yield new Response(i.readable).arrayBuffer();return yield a,h})}function sn(n,t=1/0){return R(this,null,function*(){const e=_=>_[0]===31&&_[1]===139&&_[2]===8?"gzip":_[0]===120&&[1,94,156,218].includes(_[1])?"deflate":"deflate-raw",i=new Uint8Array(n),r=e(i),a=new DecompressionStream(r),o=new TransformStream({transform(_,m){m.enqueue(_)},flush(_){_.terminate()}}),{readable:h,writable:s}=a,l=s.getWriter(),u=h.pipeThrough(o).getReader();l.write(i).catch(_=>{_ instanceof Error&&_.name});const f=[];let d=0;try{for(;d<t;){const{done:_,value:m}=yield u.read();if(_)break;const b=t-d,M=m.subarray(0,Math.min(m.length,b));if(f.push(M),d+=M.length,d>=t){yield Promise.all([u.cancel().catch(()=>{}),l.abort().catch(()=>{})]);break}}}catch(_){_ instanceof Error&&_.name}finally{yield Promise.allSettled([u.cancel().catch(()=>{}),l.close().catch(()=>{})])}return f.length===1?f[0].buffer:f.reduce((_,m)=>{const b=new Uint8Array(_.byteLength+m.byteLength);return b.set(new Uint8Array(_),0),b.set(m,_.byteLength),b.buffer},new ArrayBuffer(0))})}function ki(n,t=!1){let e=null;if(Xn(n)&&(n=Ui(n)),Mi(n,t)?e=new D:Ni(n,t)&&(e=new tt),e)e.readHeader(n);else throw new Error("That file does not appear to be NIFTI!");return e}function Qr(n,t=!1){return R(this,null,function*(){if(!Xn(n))return ki(n,t);let e=null,i=yield sn(n,540),r=!0,a=!0;var o=new DataView(i);const h=o.getInt32(0,!0),s=o.getInt32(0,!1);if(h!==348)if(s===348)r=!1;else if(h===540)a=!1;else if(s===540)a=!1,r=!1;else throw new Error("That file does not appear to be NIFTI!");let l=Math.round(o.getFloat32(108,r));return tt&&(l=E.getUint64At(o,168,r)),l>i.byteLength&&(i=yield sn(n,l)),a?e=new D:e=new tt,e.readHeader(i),e})}function Jr(n){return n.extensionFlag[0]!=0}function ts(n,t){var e=n.vox_offset,i=1,r=1;n.dims[4]&&(i=n.dims[4]),n.dims[5]&&(r=n.dims[5]);var a=n.dims[1]*n.dims[2]*n.dims[3]*i*r*(n.numBitsPerVoxel/8);return t.slice(e,e+a)}class Rt extends Error{constructor(t,e={}){super(`Node not found: ${t}`,e),this.name="NodeNotFoundError"}}class ke extends Error{constructor(t){super(`Missing key: ${t}`),this.name="KeyError"}}var nt;class Yn{constructor(t,e,i){$(this,nt);typeof t=="number"?j(this,nt,new Uint8Array(t)):t instanceof ArrayBuffer?j(this,nt,new Uint8Array(t,e,i)):j(this,nt,new Uint8Array(Array.from(t,r=>r?1:0)))}get BYTES_PER_ELEMENT(){return 1}get byteOffset(){return C(this,nt).byteOffset}get byteLength(){return C(this,nt).byteLength}get buffer(){return C(this,nt).buffer}get length(){return C(this,nt).length}get(t){let e=C(this,nt)[t];return typeof e=="number"?e!==0:e}set(t,e){C(this,nt)[t]=e?1:0}fill(t){C(this,nt).fill(t?1:0)}*[Symbol.iterator](){for(let t=0;t<this.length;t++)yield this.get(t)}}nt=new WeakMap;var yt;class Oe{constructor(t,e,i,r){g(this,"_data");g(this,"chars");$(this,yt);if(this.chars=t,j(this,yt,new TextEncoder),typeof e=="number")this._data=new Uint8Array(e*t);else if(e instanceof ArrayBuffer)r&&(r=r*t),this._data=new Uint8Array(e,i,r);else{let a=Array.from(e);this._data=new Uint8Array(a.length*t);for(let o=0;o<a.length;o++)this.set(o,a[o])}}get BYTES_PER_ELEMENT(){return this.chars}get byteOffset(){return this._data.byteOffset}get byteLength(){return this._data.byteLength}get buffer(){return this._data.buffer}get length(){return this.byteLength/this.BYTES_PER_ELEMENT}get(t){const e=new Uint8Array(this.buffer,this.byteOffset+this.chars*t,this.chars);return new TextDecoder().decode(e).replace(/\x00/g,"")}set(t,e){const i=new Uint8Array(this.buffer,this.byteOffset+this.chars*t,this.chars);i.fill(0),i.set(C(this,yt).encode(e))}fill(t){const e=C(this,yt).encode(t);for(let i=0;i<this.length;i++)this._data.set(e,i*this.chars)}*[Symbol.iterator](){for(let t=0;t<this.length;t++)yield this.get(t)}}yt=new WeakMap;var W;const Ge=class Ge{constructor(t,e,i,r){$(this,W);g(this,"chars");if(this.chars=t,typeof e=="number")j(this,W,new Int32Array(e*t));else if(e instanceof ArrayBuffer)r&&(r*=t),j(this,W,new Int32Array(e,i,r));else{const a=e,o=new Ge(t,1);j(this,W,new Int32Array(function*(){for(let h of a)o.set(0,h),yield*tn(C(o,W))}()))}}get BYTES_PER_ELEMENT(){return C(this,W).BYTES_PER_ELEMENT*this.chars}get byteLength(){return C(this,W).byteLength}get byteOffset(){return C(this,W).byteOffset}get buffer(){return C(this,W).buffer}get length(){return C(this,W).length/this.chars}get(t){const e=this.chars*t;let i="";for(let r=0;r<this.chars;r++)i+=String.fromCodePoint(C(this,W)[e+r]);return i.replace(/\u0000/g,"")}set(t,e){var a;const i=this.chars*t,r=C(this,W).subarray(i,i+this.chars);r.fill(0);for(let o=0;o<this.chars;o++)r[o]=(a=e.codePointAt(o))!=null?a:0}fill(t){this.set(0,t);let e=C(this,W).subarray(0,this.chars);for(let i=1;i<this.length;i++)C(this,W).set(e,i*this.chars)}*[Symbol.iterator](){for(let t=0;t<this.length;t++)yield this.get(t)}};W=new WeakMap;let St=Ge;const Oi="modulepreload",qi=function(n){return"/"+n},on={},me=function(t,e,i){let r=Promise.resolve();if(e&&e.length>0){let s=function(l){return Promise.all(l.map(u=>Promise.resolve(u).then(f=>({status:"fulfilled",value:f}),f=>({status:"rejected",reason:f}))))};document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),h=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));r=s(e.map(l=>{if(l=qi(l),l in on)return;on[l]=!0;const u=l.endsWith(".css"),f=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${f}`))return;const d=document.createElement("link");if(d.rel=u?"stylesheet":Oi,u||(d.as="script"),d.crossOrigin="",d.href=l,h&&d.setAttribute("nonce",h),document.head.appendChild(d),u)return new Promise((_,m)=>{d.addEventListener("load",_),d.addEventListener("error",()=>m(new Error(`Unable to preload CSS for ${l}`)))})}))}function a(o){const h=new Event("vite:preloadError",{cancelable:!0});if(h.payload=o,window.dispatchEvent(h),!h.defaultPrevented)throw o}return r.then(o=>{for(const h of o||[])h.status==="rejected"&&a(h.reason);return t().catch(a)})};function Lt(n){const t=new TextDecoder().decode(n);return JSON.parse(t)}function an(n,t){const e=t/2,i=t-1;let r=0;for(let a=0;a<n.length;a+=t)for(let o=0;o<e;o+=1)r=n[a+o],n[a+o]=n[a+i-o],n[a+i-o]=r}function Zn(n){if(n==="v2:object")return globalThis.Array;let t=n.match(/v2:([US])(\d+)/);if(t){let[,i,r]=t;return(i==="U"?St:Oe).bind(null,Number(r))}let e={int8:Int8Array,int16:Int16Array,int32:Int32Array,int64:globalThis.BigInt64Array,uint8:Uint8Array,uint16:Uint16Array,uint32:Uint32Array,uint64:globalThis.BigUint64Array,float16:globalThis.Float16Array,float32:Float32Array,float64:Float64Array,bool:Yn}[n];return V(e,`Unknown or unsupported data_type: ${n}`),e}function ut(n,t){const e=n.length;typeof t=="string"&&(t=t==="C"?Array.from({length:e},(a,o)=>o):Array.from({length:e},(a,o)=>e-1-o)),V(e===t.length,"Order length must match the number of dimensions.");let i=1,r=new Array(e);for(let a=t.length-1;a>=0;a--)r[t[a]]=i,i*=n[t[a]];return r}function Di({name:n,configuration:t}){var e,i;if(n==="default"){const r=(e=t==null?void 0:t.separator)!=null?e:"/";return a=>["c",...a].join(r)}if(n==="v2"){const r=(i=t==null?void 0:t.separator)!=null?i:".";return a=>a.join(r)||"0"}throw new Error(`Unknown chunk key encoding: ${n}`)}function Bi(n){var a;if(n==="|O")return{data_type:"v2:object"};let t=n.match(/^([<|>])(.*)$/);V(t,`Invalid dtype: ${n}`);let[,e,i]=t,r=(a={b1:"bool",i1:"int8",u1:"uint8",i2:"int16",u2:"uint16",i4:"int32",u4:"uint32",i8:"int64",u8:"uint64",f2:"float16",f4:"float32",f8:"float64"}[i])!=null?a:i.startsWith("S")||i.startsWith("U")?`v2:${i}`:void 0;return V(r,`Unsupported or unknown dtype: ${n}`),e==="|"?{data_type:r}:{data_type:r,endian:e==="<"?"little":"big"}}function Pi(n,t={}){var r,s;let e=[],i=Bi(n.dtype);n.order==="F"&&e.push({name:"transpose",configuration:{order:"F"}}),"endian"in i&&i.endian==="big"&&e.push({name:"bytes",configuration:{endian:"big"}});for(let a of(r=n.filters)!=null?r:[]){let o=a,{id:l}=o,u=le(o,["id"]);e.push({name:l,configuration:u})}if(n.compressor){let h=n.compressor,{id:l}=h,u=le(h,["id"]);e.push({name:l,configuration:u})}return{zarr_format:3,node_type:"array",shape:n.shape,data_type:i.data_type,chunk_grid:{name:"regular",configuration:{chunk_shape:n.chunks}},chunk_key_encoding:{name:"v2",configuration:{separator:(s=n.dimension_separator)!=null?s:"."}},codecs:e,fill_value:n.fill_value,attributes:t}}function Ri(n,t={}){return{zarr_format:3,node_type:"group",attributes:t}}function Li(n,t){if(t!=="number"&&t!=="bigint"&&t!=="boolean"&&t!=="object"&&t!=="string")return n===t;let e=n==="bool";if(t==="boolean")return e;let i=n.startsWith("v2:U")||n.startsWith("v2:S");if(t==="string")return i;let r=n==="int64"||n==="uint64";if(t==="bigint")return r;let a=n==="v2:object";return t==="object"?a:!i&&!r&&!e&&!a}function zi(n){return(n==null?void 0:n.name)==="sharding_indexed"}function $n(n){return(n.data_type==="uint64"||n.data_type==="int64")&&n.fill_value!=null?BigInt(n.fill_value):n.fill_value}function Vn(n,...t){if(!t.some(e=>n instanceof e))throw n}function V(n,t=""){if(!n)throw new Error(t)}function Hn(i,r){return R(this,arguments,function*(n,{format:t,signal:e}){const a=n instanceof Response?n:new Response(n);V(a.body,"Response does not contain body.");try{return yield new Response(a.body.pipeThrough(new DecompressionStream(t),{signal:e})).arrayBuffer()}catch(o){throw e==null||e.throwIfAborted(),new Error(`Failed to decode ${t}`)}})}class qe{constructor(t,e){g(this,"kind","array_to_array");V(t.keepbits>=0,"keepbits must be zero or positive")}static fromConfig(t,e){return new qe(t,e)}encode(t){throw new Error("`BitroundCodec.encode` is not implemented. Please open an issue at https://github.com/manzt/zarrita.js/issues.")}decode(t){return t}}const fn=Gi();function Gi(){const n=new Uint32Array([305419896]);return new Uint8Array(n.buffer,n.byteOffset,n.byteLength)[0]!==18}function hn(n){return"BYTES_PER_ELEMENT"in n?n.BYTES_PER_ELEMENT:4}var It,at,Ft,Tt,mt;const je=class je{constructor(t,e){g(this,"kind","array_to_bytes");$(this,It);$(this,at);$(this,Ft);$(this,Tt);$(this,mt);j(this,mt,t==null?void 0:t.endian),j(this,at,Zn(e.data_type)),j(this,Tt,e.shape),j(this,It,ut(e.shape,"C"));const i=new(C(this,at))(0);j(this,Ft,i.BYTES_PER_ELEMENT)}static fromConfig(t,e){return new je(t,e)}encode(t){let e=new Uint8Array(t.data.buffer);return fn&&C(this,mt)==="big"&&an(e,hn(C(this,at))),e}decode(t){return fn&&C(this,mt)==="big"&&an(t,hn(C(this,at))),{data:new(C(this,at))(t.buffer,t.byteOffset,t.byteLength/C(this,Ft)),shape:C(this,Tt),stride:C(this,It)}}};It=new WeakMap,at=new WeakMap,Ft=new WeakMap,Tt=new WeakMap,mt=new WeakMap;let ne=je;class De{constructor(){g(this,"kind","bytes_to_bytes")}static fromConfig(){return new De}encode(t){throw new Error("Not implemented")}decode(t){return new Uint8Array(t.buffer,t.byteOffset,t.byteLength-4)}}class Be{constructor(){g(this,"kind","bytes_to_bytes")}static fromConfig(t){return new Be}encode(t){throw new Error("Gzip encoding is not enabled by default. Please register a custom codec with `numcodecs/gzip`.")}decode(t){return R(this,null,function*(){const e=yield Hn(t,{format:"gzip"});return new Uint8Array(e)})}}function ji(n,t){return V(!Number.isNaN(t),"JsonCodec allow_nan is false but NaN was encountered during encoding."),V(t!==Number.POSITIVE_INFINITY,"JsonCodec allow_nan is false but Infinity was encountered during encoding."),V(t!==Number.NEGATIVE_INFINITY,"JsonCodec allow_nan is false but -Infinity was encountered during encoding."),t}function Xi(n,t){return t instanceof Object&&!Array.isArray(t)?Object.keys(t).sort().reduce((e,i)=>(e[i]=t[i],e),{}):t}var Ct,Mt;const Xe=class Xe{constructor(t={}){g(this,"configuration");g(this,"kind","array_to_bytes");$(this,Ct);$(this,Mt);this.configuration=t;const{encoding:e="utf-8",skipkeys:i=!1,ensure_ascii:r=!0,check_circular:a=!0,allow_nan:o=!0,sort_keys:h=!0,indent:s,strict:l=!0}=t;let u=t.separators;u||(s?u=[", ",": "]:u=[",",":"]),j(this,Ct,{encoding:e,skipkeys:i,ensure_ascii:r,check_circular:a,allow_nan:o,indent:s,separators:u,sort_keys:h}),j(this,Mt,{strict:l})}static fromConfig(t){return new Xe(t)}encode(t){const{indent:e,encoding:i,ensure_ascii:r,check_circular:a,allow_nan:o,sort_keys:h}=C(this,Ct);V(i==="utf-8","JsonCodec does not yet support non-utf-8 encoding.");const s=[];V(a,"JsonCodec does not yet support skipping the check for circular references during encoding."),o||s.push(ji),h&&s.push(Xi);const l=Array.from(t.data);l.push("|O"),l.push(t.shape);let u;s.length&&(u=(d,_)=>{let m=_;for(let b of s)m=b(d,m);return m});let f=JSON.stringify(l,u,e);return r&&(f=f.replace(/[\u007F-\uFFFF]/g,d=>{const _=`0000${d.charCodeAt(0).toString(16)}`;return`\\u${_.substring(_.length-4)}`})),new TextEncoder().encode(f)}decode(t){const{strict:e}=C(this,Mt);V(e,"JsonCodec does not yet support non-strict decoding.");const i=Lt(t),r=i.pop();i.pop(),V(r,"0D not implemented for JsonCodec.");const a=ut(r,"C");return{data:i,shape:r,stride:a}}};Ct=new WeakMap,Mt=new WeakMap;let ve=Xe;function cn(n){return n instanceof Yn||n instanceof Oe||n instanceof St?new Proxy(n,{get(e,i){return e.get(Number(i))},set(e,i,r){return e.set(Number(i),r),!0}}):n}function Yi(n,t){let e;return n.data instanceof Oe||n.data instanceof St?e=new n.constructor(n.data.length,n.data.chars):e=new n.constructor(n.data.length),{data:e,shape:n.shape,stride:ut(n.shape,t)}}function Zi(n,t){let e=Yi(n,t),i=n.shape.length,r=n.data.length,a=Array(i).fill(0),o=cn(n.data),h=cn(e.data);for(let s=0;s<r;s++){let l=0;for(let u=0;u<i;u++)l+=a[u]*e.stride[u];h[l]=o[s],a[0]+=1;for(let u=0;u<i;u++)if(a[u]===n.shape[u]){if(u+1===i)break;a[u]=0,a[u+1]+=1}}return e}function $i(n){let t=n.shape.length;return V(t===n.stride.length,"Shape and stride must have the same length."),n.stride.map((e,i)=>({stride:e,index:i})).sort((e,i)=>i.stride-e.stride).map(e=>e.index)}function Vi(n,t){let e=$i(n);return V(e.length===t.length,"Orders must match"),e.every((i,r)=>i===t[r])}var Nt,Et;const Ye=class Ye{constructor(t,e){g(this,"kind","array_to_array");$(this,Nt);$(this,Et);var h;let i=(h=t.order)!=null?h:"C",r=e.shape.length,a=new Array(r),o=new Array(r);if(i==="C")for(let s=0;s<r;++s)a[s]=s,o[s]=s;else if(i==="F")for(let s=0;s<r;++s)a[s]=r-s-1,o[s]=r-s-1;else a=i,a.forEach((s,l)=>{V(o[s]===void 0,`Invalid permutation: ${JSON.stringify(i)}`),o[s]=l});j(this,Nt,a),j(this,Et,o)}static fromConfig(t,e){return new Ye(t,e)}encode(t){return Vi(t,C(this,Et))?t:Zi(t,C(this,Et))}decode(t){return{data:t.data,shape:t.shape,stride:ut(t.shape,C(this,Nt))}}};Nt=new WeakMap,Et=new WeakMap;let Ae=Ye;var Ut,kt;const Ze=class Ze{constructor(t){g(this,"kind","array_to_bytes");$(this,Ut);$(this,kt);j(this,Ut,t),j(this,kt,ut(t,"C"))}static fromConfig(t,e){return new Ze(e.shape)}encode(t){throw new Error("Method not implemented.")}decode(t){let e=new TextDecoder,i=new DataView(t.buffer),r=Array(i.getUint32(0,!0)),a=4;for(let o=0;o<r.length;o++){let h=i.getUint32(a,!0);a+=4,r[o]=e.decode(t.buffer.slice(a,a+h)),a+=h}return{data:r,shape:C(this,Ut),stride:C(this,kt)}}};Ut=new WeakMap,kt=new WeakMap;let Se=Ze;class Pe{constructor(){g(this,"kind","bytes_to_bytes")}static fromConfig(t){return new Pe}encode(t){throw new Error("Zlib encoding is not enabled by default. Please register a codec with `numcodecs/zlib`.")}decode(t){return R(this,null,function*(){const e=yield Hn(t,{format:"deflate"});return new Uint8Array(e)})}}function Hi(){return new Map().set("blosc",()=>me(()=>import("./vendor-compression-vXTVV8dv.js").then(n=>n.b),[]).then(n=>n.default)).set("lz4",()=>me(()=>import("./vendor-compression-vXTVV8dv.js").then(n=>n.l),[]).then(n=>n.default)).set("zstd",()=>me(()=>import("./vendor-compression-vXTVV8dv.js").then(n=>n.z),[]).then(n=>n.default)).set("gzip",()=>Be).set("zlib",()=>Pe).set("transpose",()=>Ae).set("bytes",()=>ne).set("crc32c",()=>De).set("vlen-utf8",()=>Se).set("json2",()=>ve).set("bitround",()=>qe)}const Wi=Hi();function Ie(n){let t;return{encode(i){return R(this,null,function*(){t||(t=yield ln(n));for(const a of t.array_to_array)i=yield a.encode(i);let r=yield t.array_to_bytes.encode(i);for(const a of t.bytes_to_bytes)r=yield a.encode(r);return r})},decode(i){return R(this,null,function*(){t||(t=yield ln(n));for(let a=t.bytes_to_bytes.length-1;a>=0;a--)i=yield t.bytes_to_bytes[a].decode(i);let r=yield t.array_to_bytes.decode(i);for(let a=t.array_to_array.length-1;a>=0;a--)r=yield t.array_to_array[a].decode(r);return r})}}}function ln(n){return R(this,null,function*(){let t=n.codecs.map(l=>R(null,null,function*(){var f;let u=yield(f=Wi.get(l.name))==null?void 0:f();return V(u,`Unknown codec: ${l.name}`),{Codec:u,meta:l}})),e=[],i,r=[];try{for(var a=en(t),o,h,s;o=!(h=yield a.next()).done;o=!1){let{Codec:l,meta:u}=h.value;let f=l.fromConfig(u.configuration,n);switch(f.kind){case"array_to_array":e.push(f);break;case"array_to_bytes":i=f;break;default:r.push(f)}}}catch(h){s=[h]}finally{try{o&&(h=a.return)&&(yield h.call(a))}finally{if(s)throw s[0]}}return i||(V(Ki(n),`Cannot encode ${n.data_type} to bytes without a codec`),i=ne.fromConfig({endian:"little"},n)),{array_to_array:e,array_to_bytes:i,bytes_to_bytes:r}})}function Ki(n){return n.data_type!=="v2:object"}const un=BigInt("18446744073709551615");function Qi(n,t,e,i){V(n.store.getRange,"Store does not support range requests");let r=n.store.getRange.bind(n.store),a=t.map((s,l)=>s/i.chunk_shape[l]),o=Ie({data_type:"uint64",shape:[...a,2],codecs:i.index_codecs}),h={};return s=>R(null,null,function*(){let l=s.map((I,O)=>Math.floor(I/a[O])),u=n.resolve(e(l)).path,f;if(u in h)f=h[u];else{let I=4,O=16*a.reduce((k,L)=>k*L,1),S=yield r(u,{suffixLength:O+I});f=h[u]=S?yield o.decode(S):null}if(f===null)return;let{data:d,shape:_,stride:m}=f,b=s.map((I,O)=>I%_[O]).reduce((I,O,S)=>I+O*m[S],0),M=d[b],A=d[b+1];if(!(M===un&&A===un))return r(u,{offset:Number(M),length:Number(A)})})}class dt{constructor(t,e="/"){g(this,"store");g(this,"path");this.store=t,this.path=e}resolve(t){let e=new URL(`file://${this.path.endsWith("/")?this.path:`${this.path}/`}`);return new dt(this.store,new URL(t,e).pathname)}}function es(n){return new dt(n!=null?n:new Map)}var Ot;class Re extends dt{constructor(e,i,r){super(e,i);g(this,"kind","group");$(this,Ot);j(this,Ot,r)}get attrs(){return C(this,Ot).attributes}}Ot=new WeakMap;function dn(n){var e,i;const t=n.find(r=>r.name==="transpose");return(i=(e=t==null?void 0:t.configuration)==null?void 0:e.order)!=null?i:"C"}const vt=Symbol("zarrita.context");function Ji(n){return n[vt]}function tr(n,t){var a;let{configuration:e}=(a=t.codecs.find(zi))!=null?a:{},i={encode_chunk_key:Di(t.chunk_key_encoding),TypedArray:Zn(t.data_type),fill_value:t.fill_value};if(e){let h=dn(e.codecs);return rt(et({},i),{kind:"sharded",chunk_shape:e.chunk_shape,codec:Ie({data_type:t.data_type,shape:e.chunk_shape,codecs:e.codecs}),get_strides(s){return ut(s,h)},get_chunk_bytes:Qi(n,t.chunk_grid.configuration.chunk_shape,i.encode_chunk_key,e)})}let r=dn(t.codecs);return rt(et({},i),{kind:"regular",chunk_shape:t.chunk_grid.configuration.chunk_shape,codec:Ie({data_type:t.data_type,shape:t.chunk_grid.configuration.chunk_shape,codecs:t.codecs}),get_strides(h){return ut(h,r)},get_chunk_bytes(h,s){return R(this,null,function*(){let l=i.encode_chunk_key(h),u=n.resolve(l).path;return n.store.get(u,s)})}})}var Cn,Mn,lt,Nn;let ie=(Nn=class extends(Mn=dt,Cn=vt,Mn){constructor(e,i,r){super(e,i);g(this,"kind","array");$(this,lt);g(this,Cn);j(this,lt,rt(et({},r),{fill_value:$n(r)})),this[vt]=tr(this,r)}get attrs(){return C(this,lt).attributes}get shape(){return C(this,lt).shape}get chunks(){return this[vt].chunk_shape}get dtype(){return C(this,lt).data_type}getChunk(e,i){return R(this,null,function*(){let r=this[vt],a=yield r.get_chunk_bytes(e,i);if(!a){let o=r.chunk_shape.reduce((s,l)=>s*l,1),h=new r.TypedArray(o);return h.fill(r.fill_value),{data:h,shape:r.chunk_shape,stride:r.get_strides(r.chunk_shape)}}return r.codec.decode(a)})}is(e){return Li(this.dtype,e)}},lt=new WeakMap,Nn),oe=er();function er(){let n=new WeakMap;function t(e){var r;let i=(r=n.get(e))!=null?r:{v2:0,v3:0};return n.set(e,i),i}return{increment(e,i){t(e)[i]+=1},version_max(e){let i=t(e);return i.v3>i.v2?"v3":"v2"}}}function nr(n){return R(this,null,function*(){let t=yield n.store.get(n.resolve(".zattrs").path);return t?Lt(t):{}})}function ir(e){return R(this,arguments,function*(n,t={}){var a;let i="store"in n?n:new dt(n),r={};return((a=t.attrs)==null||a)&&(r=yield nr(i)),t.kind==="array"?gn(i,r):t.kind==="group"?_n(i,r):gn(i,r).catch(o=>(Vn(o,Rt),_n(i,r)))})}function gn(n,t){return R(this,null,function*(){let{path:e}=n.resolve(".zarray"),i=yield n.store.get(e);if(!i)throw new Rt("v2 array",{cause:new ke(e)});return oe.increment(n.store,"v2"),new ie(n.store,n.path,Pi(Lt(i),t))})}function _n(n,t){return R(this,null,function*(){let{path:e}=n.resolve(".zgroup"),i=yield n.store.get(e);if(!i)throw new Rt("v2 group",{cause:new ke(e)});return oe.increment(n.store,"v2"),new Re(n.store,n.path,Ri(Lt(i),t))})}function rr(n){return R(this,null,function*(){let{store:t,path:e}=n.resolve("zarr.json"),i=yield n.store.get(e);if(!i)throw new Rt("v3 array or group",{cause:new ke(e)});let r=Lt(i);return r.node_type==="array"&&(r.fill_value=$n(r)),r.node_type==="array"?new ie(t,n.path,r):new Re(t,n.path,r)})}function sr(e){return R(this,arguments,function*(n,t={}){let i="store"in n?n:new dt(n),r=yield rr(i);if(oe.increment(i.store,"v3"),t.kind===void 0||t.kind==="array"&&r instanceof ie||t.kind==="group"&&r instanceof Re)return r;let a=r instanceof ie?"array":"group";throw new Error(`Expected node of kind ${t.kind}, found ${a}.`)})}function pt(e){return R(this,arguments,function*(n,t={}){let i="store"in n?n.store:n,r=oe.version_max(i),a=r==="v2"?pt.v2:pt.v3,o=r==="v2"?pt.v3:pt.v2;return a(n,t).catch(h=>(Vn(h,Rt),o(n,t)))})}pt.v2=ir;pt.v3=sr;function*or(n,t,e=1){t===void 0&&(t=n,n=0);for(let i=n;i<t;i+=e)yield i}function*ar(...n){if(n.length===0)return;const t=n.map(i=>i[Symbol.iterator]()),e=t.map(i=>i.next());if(e.some(i=>i.done))throw new Error("Input contains an empty iterator.");for(let i=0;;){if(e[i].done){if(t[i]=n[i][Symbol.iterator](),e[i]=t[i].next(),++i>=t.length)return}else yield e.map(({value:r})=>r),i=0;e[i]=t[i].next()}}function fr({start:n,stop:t,step:e},i){if(e===0)throw new Error("slice step cannot be zero");e=e!=null?e:1;const r=e<0,[a,o]=r?[-1,i-1]:[0,i];return n===null?n=r?o:a:n<0?(n+=i,n<a&&(n=a)):n>o&&(n=o),t===null?t=r?a:o:t<0?(t+=i,t<a&&(t=a)):t>o&&(t=o),[n,t,e]}function pn(n,t,e=null){return t===void 0&&(t=n,n=null),{start:n,stop:t,step:e}}function hr(){const n=[];return{add:t=>n.push(t()),onIdle:()=>Promise.all(n)}}class Le extends Error{constructor(t){super(t),this.name="IndexError"}}function cr(n,t){throw new Le(`too many indicies for array; expected ${t.length}, got ${n.length}`)}function lr(n){throw new Le(`index out of bounds for dimension with length ${n}`)}function ur(){throw new Le("only slices with step >= 1 are supported")}function dr(n,t){n.length>t.length&&cr(n,t)}function gr(n,t){return n=Math.trunc(n),n<0&&(n=t+n),(n>=t||n<0)&&lr(t),n}class _r{constructor({dim_sel:t,dim_len:e,dim_chunk_len:i}){g(this,"dim_sel");g(this,"dim_len");g(this,"dim_chunk_len");g(this,"nitems");t=gr(t,e),this.dim_sel=t,this.dim_len=e,this.dim_chunk_len=i,this.nitems=1}*[Symbol.iterator](){const t=Math.floor(this.dim_sel/this.dim_chunk_len),e=t*this.dim_chunk_len,i=this.dim_sel-e;yield{dim_chunk_ix:t,dim_chunk_sel:i}}}class yn{constructor({dim_sel:t,dim_len:e,dim_chunk_len:i}){g(this,"start");g(this,"stop");g(this,"step");g(this,"dim_len");g(this,"dim_chunk_len");g(this,"nitems");g(this,"nchunks");const[r,a,o]=fr(t,e);this.start=r,this.stop=a,this.step=o,this.step<1&&ur(),this.dim_len=e,this.dim_chunk_len=i,this.nitems=Math.max(0,Math.ceil((this.stop-this.start)/this.step)),this.nchunks=Math.ceil(this.dim_len/this.dim_chunk_len)}*[Symbol.iterator](){const t=Math.floor(this.start/this.dim_chunk_len),e=Math.ceil(this.stop/this.dim_chunk_len);for(const i of or(t,e)){const r=i*this.dim_chunk_len,a=Math.min(this.dim_len,(i+1)*this.dim_chunk_len),o=a-r;let h=0,s=0;if(this.start<r){const _=(r-this.start)%this.step;_&&(s+=this.step-_),h=Math.ceil((r-this.start)/this.step)}else s=this.start-r;const l=this.stop>a?o:this.stop-r,u=[s,l,this.step],f=Math.ceil((l-s)/this.step),d=[h,h+f,1];yield{dim_chunk_ix:i,dim_chunk_sel:u,dim_out_sel:d}}}}function pr(n,t){let e=[];return n===null?e=t.map(i=>pn(null)):Array.isArray(n)&&(e=n.map(i=>i!=null?i:pn(null))),dr(e,t),e}class yr{constructor({selection:t,shape:e,chunk_shape:i}){g(this,"dim_indexers");g(this,"shape");this.dim_indexers=pr(t,e).map((r,a)=>new(typeof r=="number"?_r:yn)({dim_sel:r,dim_len:e[a],dim_chunk_len:i[a]})),this.shape=this.dim_indexers.filter(r=>r instanceof yn).map(r=>r.nitems)}*[Symbol.iterator](){for(const t of ar(...this.dim_indexers)){const e=t.map(r=>r.dim_chunk_ix),i=t.map(r=>"dim_out_sel"in r?{from:r.dim_chunk_sel,to:r.dim_out_sel}:{from:r.dim_chunk_sel,to:null});yield{chunk_coords:e,mapping:i}}}}function mr(n,t){return"get"in n?n.get(t):n[t]}function Er(n,t,e,i){return R(this,null,function*(){var s,l;let r=Ji(n),a=new yr({selection:t,shape:n.shape,chunk_shape:n.chunks}),o=i.prepare(new r.TypedArray(a.shape.reduce((u,f)=>u*f,1)),a.shape,r.get_strides(a.shape)),h=(l=(s=e.create_queue)==null?void 0:s.call(e))!=null?l:hr();for(const{chunk_coords:u,mapping:f}of a)h.add(()=>R(null,null,function*(){let{data:d,shape:_,stride:m}=yield n.getChunk(u,e.opts),b=i.prepare(d,_,m);i.set_from_chunk(o,b,f)}));return yield h.onIdle(),a.shape.length===0?mr(o.data,0):o})}function ze(n,t=0,e){let i=e!=null?e:n.length-t;return{length:i,subarray(r,a=i){return ze(n,t+r,a-r)},set(r,a=0){for(let o=0;o<r.length;o++)n[t+a+o]=r.get(o)},get(r){return n[t+r]}}}function Ee(n){return globalThis.Array.isArray(n.data)?{data:ze(n.data),stride:n.stride,bytes_per_element:1}:{data:new Uint8Array(n.data.buffer,n.data.byteOffset,n.data.byteLength),stride:n.stride,bytes_per_element:n.data.BYTES_PER_ELEMENT}}function wr(n){return"chars"in n?n.constructor.bind(null,n.chars):n.constructor}function xr(n,t){if(globalThis.Array.isArray(n.data))return ze([t]);let e=wr(n.data),i=new e([t]);return new Uint8Array(i.buffer,i.byteOffset,i.byteLength)}const br={prepare(n,t,e){return{data:n,shape:t,stride:e}},set_scalar(n,t,e){let i=Ee(n);Fe(i,t,xr(n,e),i.bytes_per_element)},set_from_chunk(n,t,e){let i=Ee(n);Zt(i,Ee(t),i.bytes_per_element,e)}};function is(i){return R(this,arguments,function*(n,t=null,e={}){return Er(n,t,e,br)})}function Wn(n,t,e){return e<0&&t<n?Math.floor((n-t-1)/-e)+1:n<t?Math.floor((t-n-1)/e)+1:0}function Fe(n,t,e,i){if(t.length===0){n.data.set(e,0);return}const[r,...a]=t,[o,...h]=n.stride;if(typeof r=="number"){const d=n.data.subarray(o*r*i);Fe({data:d,stride:h},a,e,i);return}const[s,l,u]=r,f=Wn(s,l,u);if(a.length===0){for(let d=0;d<f;d++)n.data.set(e,o*(s+u*d)*i);return}for(let d=0;d<f;d++){const _=n.data.subarray(o*(s+u*d)*i);Fe({data:_,stride:h},a,e,i)}}function Zt(n,t,e,i){const[r,...a]=i,[o,...h]=n.stride,[s,...l]=t.stride;if(r.from===null){if(a.length===0){n.data.set(t.data.subarray(0,e),r.to*e);return}Zt({data:n.data.subarray(o*r.to*e),stride:h},t,e,a);return}if(r.to===null){if(a.length===0){let A=r.from*e;n.data.set(t.data.subarray(A,A+e),0);return}Zt(n,{data:t.data.subarray(s*r.from*e),stride:l},e,a);return}const[u,f,d]=r.to,[_,m,b]=r.from,M=Wn(u,f,d);if(a.length===0){if(d===1&&b===1&&o===1&&s===1){let A=_*e,I=M*e;n.data.set(t.data.subarray(A,A+I),u*e);return}for(let A=0;A<M;A++){let I=s*(_+b*A)*e;n.data.set(t.data.subarray(I,I+e),o*(u+d*A)*e)}return}for(let A=0;A<M;A++)Zt({data:n.data.subarray(o*(u+A*d)*e),stride:h},{data:t.data.subarray(s*(_+A*b)*e),stride:l},e,a)}function Kn(n,t,e,i={}){return t!==void 0&&e!==void 0&&(i=rt(et({},i),{headers:rt(et({},i.headers),{Range:`bytes=${t}-${t+e-1}`})})),fetch(n,i)}function vr(n,t){return rt(et(et({},n),t),{headers:et(et({},n.headers),t.headers)})}function mn(n,t){const e=typeof n=="string"?new URL(n):n;e.pathname.endsWith("/")||(e.pathname+="/");const i=new URL(t.slice(1),e);return i.search=e.search,i}function En(n){return R(this,null,function*(){if(n.status!==404){if(n.status===200||n.status===206)return new Uint8Array(yield n.arrayBuffer());throw new Error(`Unexpected response status ${n.status} ${n.statusText}`)}})}function Ar(n,t,e,i){return R(this,null,function*(){if(i)return fetch(n,rt(et({},e),{headers:rt(et({},e.headers),{Range:`bytes=-${t}`})}));let r=yield fetch(n,rt(et({},e),{method:"HEAD"}));if(!r.ok)return r;let a=r.headers.get("Content-Length"),o=Number(a);return Kn(n,o-t,o,e)})}var qt,Dt,Bt,Te;class rs{constructor(t,e={}){$(this,Bt);g(this,"url");$(this,qt);$(this,Dt);var i,r;this.url=t,j(this,qt,(i=e.overrides)!=null?i:{}),j(this,Dt,(r=e.useSuffixRequest)!=null?r:!1)}get(i){return R(this,arguments,function*(t,e={}){let r=mn(this.url,t).href,a=yield fetch(r,de(this,Bt,Te).call(this,e));return En(a)})}getRange(r,a){return R(this,arguments,function*(t,e,i={}){let o=mn(this.url,t),h=de(this,Bt,Te).call(this,i),s;return"suffixLength"in e?s=yield Ar(o,e.suffixLength,h,C(this,Dt)):s=yield Kn(o,e.offset,e.length,h),En(s)})}}qt=new WeakMap,Dt=new WeakMap,Bt=new WeakSet,Te=function(t){return vr(C(this,qt),t)};var we,wn;function Sr(){if(wn)return we;wn=1,we=t;var n=null;try{n=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch(p){}function t(p,c,w){this.low=p|0,this.high=c|0,this.unsigned=!!w}t.prototype.__isLong__,Object.defineProperty(t.prototype,"__isLong__",{value:!0});function e(p){return(p&&p.__isLong__)===!0}t.isLong=e;var i={},r={};function a(p,c){var w,v,F;return c?(p>>>=0,(F=0<=p&&p<256)&&(v=r[p],v)?v:(w=h(p,(p|0)<0?-1:0,!0),F&&(r[p]=w),w)):(p|=0,(F=-128<=p&&p<128)&&(v=i[p],v)?v:(w=h(p,p<0?-1:0,!1),F&&(i[p]=w),w))}t.fromInt=a;function o(p,c){if(isNaN(p))return c?I:A;if(c){if(p<0)return I;if(p>=m)return B}else{if(p<=-b)return N;if(p+1>=b)return L}return p<0?o(-p,c).neg():h(p%_|0,p/_|0,c)}t.fromNumber=o;function h(p,c,w){return new t(p,c,w)}t.fromBits=h;var s=Math.pow;function l(p,c,w){if(p.length===0)throw Error("empty string");if(p==="NaN"||p==="Infinity"||p==="+Infinity"||p==="-Infinity")return A;if(typeof c=="number"?(w=c,c=!1):c=!!c,w=w||10,w<2||36<w)throw RangeError("radix");var v;if((v=p.indexOf("-"))>0)throw Error("interior hyphen");if(v===0)return l(p.substring(1),c,w).neg();for(var F=o(s(w,8)),T=A,U=0;U<p.length;U+=8){var P=Math.min(8,p.length-U),G=parseInt(p.substring(U,U+P),w);if(P<8){var q=o(s(w,P));T=T.mul(q).add(o(G))}else T=T.mul(F),T=T.add(o(G))}return T.unsigned=c,T}t.fromString=l;function u(p,c){return typeof p=="number"?o(p,c):typeof p=="string"?l(p,c):h(p.low,p.high,typeof c=="boolean"?c:p.unsigned)}t.fromValue=u;var f=65536,d=1<<24,_=f*f,m=_*_,b=m/2,M=a(d),A=a(0);t.ZERO=A;var I=a(0,!0);t.UZERO=I;var O=a(1);t.ONE=O;var S=a(1,!0);t.UONE=S;var k=a(-1);t.NEG_ONE=k;var L=h(-1,2147483647,!1);t.MAX_VALUE=L;var B=h(-1,-1,!0);t.MAX_UNSIGNED_VALUE=B;var N=h(0,-2147483648,!1);t.MIN_VALUE=N;var y=t.prototype;return y.toInt=function(){return this.unsigned?this.low>>>0:this.low},y.toNumber=function(){return this.unsigned?(this.high>>>0)*_+(this.low>>>0):this.high*_+(this.low>>>0)},y.toString=function(c){if(c=c||10,c<2||36<c)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative())if(this.eq(N)){var w=o(c),v=this.div(w),F=v.mul(w).sub(this);return v.toString(c)+F.toInt().toString(c)}else return"-"+this.neg().toString(c);for(var T=o(s(c,6),this.unsigned),U=this,P="";;){var G=U.div(T),q=U.sub(G.mul(T)).toInt()>>>0,X=q.toString(c);if(U=G,U.isZero())return X+P;for(;X.length<6;)X="0"+X;P=""+X+P}},y.getHighBits=function(){return this.high},y.getHighBitsUnsigned=function(){return this.high>>>0},y.getLowBits=function(){return this.low},y.getLowBitsUnsigned=function(){return this.low>>>0},y.getNumBitsAbs=function(){if(this.isNegative())return this.eq(N)?64:this.neg().getNumBitsAbs();for(var c=this.high!=0?this.high:this.low,w=31;w>0&&(c&1<<w)==0;w--);return this.high!=0?w+33:w+1},y.isZero=function(){return this.high===0&&this.low===0},y.eqz=y.isZero,y.isNegative=function(){return!this.unsigned&&this.high<0},y.isPositive=function(){return this.unsigned||this.high>=0},y.isOdd=function(){return(this.low&1)===1},y.isEven=function(){return(this.low&1)===0},y.equals=function(c){return e(c)||(c=u(c)),this.unsigned!==c.unsigned&&this.high>>>31===1&&c.high>>>31===1?!1:this.high===c.high&&this.low===c.low},y.eq=y.equals,y.notEquals=function(c){return!this.eq(c)},y.neq=y.notEquals,y.ne=y.notEquals,y.lessThan=function(c){return this.comp(c)<0},y.lt=y.lessThan,y.lessThanOrEqual=function(c){return this.comp(c)<=0},y.lte=y.lessThanOrEqual,y.le=y.lessThanOrEqual,y.greaterThan=function(c){return this.comp(c)>0},y.gt=y.greaterThan,y.greaterThanOrEqual=function(c){return this.comp(c)>=0},y.gte=y.greaterThanOrEqual,y.ge=y.greaterThanOrEqual,y.compare=function(c){if(e(c)||(c=u(c)),this.eq(c))return 0;var w=this.isNegative(),v=c.isNegative();return w&&!v?-1:!w&&v?1:this.unsigned?c.high>>>0>this.high>>>0||c.high===this.high&&c.low>>>0>this.low>>>0?-1:1:this.sub(c).isNegative()?-1:1},y.comp=y.compare,y.negate=function(){return!this.unsigned&&this.eq(N)?N:this.not().add(O)},y.neg=y.negate,y.add=function(c){e(c)||(c=u(c));var w=this.high>>>16,v=this.high&65535,F=this.low>>>16,T=this.low&65535,U=c.high>>>16,P=c.high&65535,G=c.low>>>16,q=c.low&65535,X=0,J=0,Y=0,Z=0;return Z+=T+q,Y+=Z>>>16,Z&=65535,Y+=F+G,J+=Y>>>16,Y&=65535,J+=v+P,X+=J>>>16,J&=65535,X+=w+U,X&=65535,h(Y<<16|Z,X<<16|J,this.unsigned)},y.subtract=function(c){return e(c)||(c=u(c)),this.add(c.neg())},y.sub=y.subtract,y.multiply=function(c){if(this.isZero())return A;if(e(c)||(c=u(c)),n){var w=n.mul(this.low,this.high,c.low,c.high);return h(w,n.get_high(),this.unsigned)}if(c.isZero())return A;if(this.eq(N))return c.isOdd()?N:A;if(c.eq(N))return this.isOdd()?N:A;if(this.isNegative())return c.isNegative()?this.neg().mul(c.neg()):this.neg().mul(c).neg();if(c.isNegative())return this.mul(c.neg()).neg();if(this.lt(M)&&c.lt(M))return o(this.toNumber()*c.toNumber(),this.unsigned);var v=this.high>>>16,F=this.high&65535,T=this.low>>>16,U=this.low&65535,P=c.high>>>16,G=c.high&65535,q=c.low>>>16,X=c.low&65535,J=0,Y=0,Z=0,ft=0;return ft+=U*X,Z+=ft>>>16,ft&=65535,Z+=T*X,Y+=Z>>>16,Z&=65535,Z+=U*q,Y+=Z>>>16,Z&=65535,Y+=F*X,J+=Y>>>16,Y&=65535,Y+=T*q,J+=Y>>>16,Y&=65535,Y+=U*G,J+=Y>>>16,Y&=65535,J+=v*X+F*q+T*G+U*P,J&=65535,h(Z<<16|ft,J<<16|Y,this.unsigned)},y.mul=y.multiply,y.divide=function(c){if(e(c)||(c=u(c)),c.isZero())throw Error("division by zero");if(n){if(!this.unsigned&&this.high===-2147483648&&c.low===-1&&c.high===-1)return this;var w=(this.unsigned?n.div_u:n.div_s)(this.low,this.high,c.low,c.high);return h(w,n.get_high(),this.unsigned)}if(this.isZero())return this.unsigned?I:A;var v,F,T;if(this.unsigned){if(c.unsigned||(c=c.toUnsigned()),c.gt(this))return I;if(c.gt(this.shru(1)))return S;T=I}else{if(this.eq(N)){if(c.eq(O)||c.eq(k))return N;if(c.eq(N))return O;var U=this.shr(1);return v=U.div(c).shl(1),v.eq(A)?c.isNegative()?O:k:(F=this.sub(c.mul(v)),T=v.add(F.div(c)),T)}else if(c.eq(N))return this.unsigned?I:A;if(this.isNegative())return c.isNegative()?this.neg().div(c.neg()):this.neg().div(c).neg();if(c.isNegative())return this.div(c.neg()).neg();T=A}for(F=this;F.gte(c);){v=Math.max(1,Math.floor(F.toNumber()/c.toNumber()));for(var P=Math.ceil(Math.log(v)/Math.LN2),G=P<=48?1:s(2,P-48),q=o(v),X=q.mul(c);X.isNegative()||X.gt(F);)v-=G,q=o(v,this.unsigned),X=q.mul(c);q.isZero()&&(q=O),T=T.add(q),F=F.sub(X)}return T},y.div=y.divide,y.modulo=function(c){if(e(c)||(c=u(c)),n){var w=(this.unsigned?n.rem_u:n.rem_s)(this.low,this.high,c.low,c.high);return h(w,n.get_high(),this.unsigned)}return this.sub(this.div(c).mul(c))},y.mod=y.modulo,y.rem=y.modulo,y.not=function(){return h(~this.low,~this.high,this.unsigned)},y.and=function(c){return e(c)||(c=u(c)),h(this.low&c.low,this.high&c.high,this.unsigned)},y.or=function(c){return e(c)||(c=u(c)),h(this.low|c.low,this.high|c.high,this.unsigned)},y.xor=function(c){return e(c)||(c=u(c)),h(this.low^c.low,this.high^c.high,this.unsigned)},y.shiftLeft=function(c){return e(c)&&(c=c.toInt()),(c&=63)===0?this:c<32?h(this.low<<c,this.high<<c|this.low>>>32-c,this.unsigned):h(0,this.low<<c-32,this.unsigned)},y.shl=y.shiftLeft,y.shiftRight=function(c){return e(c)&&(c=c.toInt()),(c&=63)===0?this:c<32?h(this.low>>>c|this.high<<32-c,this.high>>c,this.unsigned):h(this.high>>c-32,this.high>=0?0:-1,this.unsigned)},y.shr=y.shiftRight,y.shiftRightUnsigned=function(c){if(e(c)&&(c=c.toInt()),c&=63,c===0)return this;var w=this.high;if(c<32){var v=this.low;return h(v>>>c|w<<32-c,w>>>c,this.unsigned)}else return c===32?h(w,0,this.unsigned):h(w>>>c-32,0,this.unsigned)},y.shru=y.shiftRightUnsigned,y.shr_u=y.shiftRightUnsigned,y.toSigned=function(){return this.unsigned?h(this.low,this.high,!1):this},y.toUnsigned=function(){return this.unsigned?this:h(this.low,this.high,!0)},y.toBytes=function(c){return c?this.toBytesLE():this.toBytesBE()},y.toBytesLE=function(){var c=this.high,w=this.low;return[w&255,w>>>8&255,w>>>16&255,w>>>24,c&255,c>>>8&255,c>>>16&255,c>>>24]},y.toBytesBE=function(){var c=this.high,w=this.low;return[c>>>24,c>>>16&255,c>>>8&255,c&255,w>>>24,w>>>16&255,w>>>8&255,w&255]},t.fromBytes=function(c,w,v){return v?t.fromBytesLE(c,w):t.fromBytesBE(c,w)},t.fromBytesLE=function(c,w){return new t(c[0]|c[1]<<8|c[2]<<16|c[3]<<24,c[4]|c[5]<<8|c[6]<<16|c[7]<<24,w)},t.fromBytesBE=function(c,w){return new t(c[4]<<24|c[5]<<16|c[6]<<8|c[7],c[0]<<24|c[1]<<16|c[2]<<8|c[3],w)},we}var Qn=Sr();const Ir=Un(Qn),ss=ri({__proto__:null,default:Ir},[Qn]);var $t={exports:{}},Fr=$t.exports,xn;function Tr(){return xn||(xn=1,function(n){(function(t,e,i){function r(s){var l=this,u=h();l.next=function(){var f=2091639*l.s0+l.c*23283064365386963e-26;return l.s0=l.s1,l.s1=l.s2,l.s2=f-(l.c=f|0)},l.c=1,l.s0=u(" "),l.s1=u(" "),l.s2=u(" "),l.s0-=u(s),l.s0<0&&(l.s0+=1),l.s1-=u(s),l.s1<0&&(l.s1+=1),l.s2-=u(s),l.s2<0&&(l.s2+=1),u=null}function a(s,l){return l.c=s.c,l.s0=s.s0,l.s1=s.s1,l.s2=s.s2,l}function o(s,l){var u=new r(s),f=l&&l.state,d=u.next;return d.int32=function(){return u.next()*4294967296|0},d.double=function(){return d()+(d()*2097152|0)*11102230246251565e-32},d.quick=d,f&&(typeof f=="object"&&a(f,u),d.state=function(){return a(u,{})}),d}function h(){var s=4022871197,l=function(u){u=String(u);for(var f=0;f<u.length;f++){s+=u.charCodeAt(f);var d=.02519603282416938*s;s=d>>>0,d-=s,d*=s,s=d>>>0,d-=s,s+=d*4294967296}return(s>>>0)*23283064365386963e-26};return l}e&&e.exports?e.exports=o:this.alea=o})(Fr,n)}($t)),$t.exports}var Vt={exports:{}},Cr=Vt.exports,bn;function Mr(){return bn||(bn=1,function(n){(function(t,e,i){function r(h){var s=this,l="";s.x=0,s.y=0,s.z=0,s.w=0,s.next=function(){var f=s.x^s.x<<11;return s.x=s.y,s.y=s.z,s.z=s.w,s.w^=s.w>>>19^f^f>>>8},h===(h|0)?s.x=h:l+=h;for(var u=0;u<l.length+64;u++)s.x^=l.charCodeAt(u)|0,s.next()}function a(h,s){return s.x=h.x,s.y=h.y,s.z=h.z,s.w=h.w,s}function o(h,s){var l=new r(h),u=s&&s.state,f=function(){return(l.next()>>>0)/4294967296};return f.double=function(){do var d=l.next()>>>11,_=(l.next()>>>0)/4294967296,m=(d+_)/(1<<21);while(m===0);return m},f.int32=l.next,f.quick=f,u&&(typeof u=="object"&&a(u,l),f.state=function(){return a(l,{})}),f}e&&e.exports?e.exports=o:this.xor128=o})(Cr,n)}(Vt)),Vt.exports}var Ht={exports:{}},Nr=Ht.exports,vn;function Ur(){return vn||(vn=1,function(n){(function(t,e,i){function r(h){var s=this,l="";s.next=function(){var f=s.x^s.x>>>2;return s.x=s.y,s.y=s.z,s.z=s.w,s.w=s.v,(s.d=s.d+362437|0)+(s.v=s.v^s.v<<4^(f^f<<1))|0},s.x=0,s.y=0,s.z=0,s.w=0,s.v=0,h===(h|0)?s.x=h:l+=h;for(var u=0;u<l.length+64;u++)s.x^=l.charCodeAt(u)|0,u==l.length&&(s.d=s.x<<10^s.x>>>4),s.next()}function a(h,s){return s.x=h.x,s.y=h.y,s.z=h.z,s.w=h.w,s.v=h.v,s.d=h.d,s}function o(h,s){var l=new r(h),u=s&&s.state,f=function(){return(l.next()>>>0)/4294967296};return f.double=function(){do var d=l.next()>>>11,_=(l.next()>>>0)/4294967296,m=(d+_)/(1<<21);while(m===0);return m},f.int32=l.next,f.quick=f,u&&(typeof u=="object"&&a(u,l),f.state=function(){return a(l,{})}),f}e&&e.exports?e.exports=o:this.xorwow=o})(Nr,n)}(Ht)),Ht.exports}var Wt={exports:{}},kr=Wt.exports,An;function Or(){return An||(An=1,function(n){(function(t,e,i){function r(h){var s=this;s.next=function(){var u=s.x,f=s.i,d,_;return d=u[f],d^=d>>>7,_=d^d<<24,d=u[f+1&7],_^=d^d>>>10,d=u[f+3&7],_^=d^d>>>3,d=u[f+4&7],_^=d^d<<7,d=u[f+7&7],d=d^d<<13,_^=d^d<<9,u[f]=_,s.i=f+1&7,_};function l(u,f){var d,_=[];if(f===(f|0))_[0]=f;else for(f=""+f,d=0;d<f.length;++d)_[d&7]=_[d&7]<<15^f.charCodeAt(d)+_[d+1&7]<<13;for(;_.length<8;)_.push(0);for(d=0;d<8&&_[d]===0;++d);for(d==8?_[7]=-1:_[d],u.x=_,u.i=0,d=256;d>0;--d)u.next()}l(s,h)}function a(h,s){return s.x=h.x.slice(),s.i=h.i,s}function o(h,s){h==null&&(h=+new Date);var l=new r(h),u=s&&s.state,f=function(){return(l.next()>>>0)/4294967296};return f.double=function(){do var d=l.next()>>>11,_=(l.next()>>>0)/4294967296,m=(d+_)/(1<<21);while(m===0);return m},f.int32=l.next,f.quick=f,u&&(u.x&&a(u,l),f.state=function(){return a(l,{})}),f}e&&e.exports?e.exports=o:this.xorshift7=o})(kr,n)}(Wt)),Wt.exports}var Kt={exports:{}},qr=Kt.exports,Sn;function Dr(){return Sn||(Sn=1,function(n){(function(t,e,i){function r(h){var s=this;s.next=function(){var u=s.w,f=s.X,d=s.i,_,m;return s.w=u=u+1640531527|0,m=f[d+34&127],_=f[d=d+1&127],m^=m<<13,_^=_<<17,m^=m>>>15,_^=_>>>12,m=f[d]=m^_,s.i=d,m+(u^u>>>16)|0};function l(u,f){var d,_,m,b,M,A=[],I=128;for(f===(f|0)?(_=f,f=null):(f=f+"\0",_=0,I=Math.max(I,f.length)),m=0,b=-32;b<I;++b)f&&(_^=f.charCodeAt((b+32)%f.length)),b===0&&(M=_),_^=_<<10,_^=_>>>15,_^=_<<4,_^=_>>>13,b>=0&&(M=M+1640531527|0,d=A[b&127]^=_+M,m=d==0?m+1:0);for(m>=128&&(A[(f&&f.length||0)&127]=-1),m=127,b=512;b>0;--b)_=A[m+34&127],d=A[m=m+1&127],_^=_<<13,d^=d<<17,_^=_>>>15,d^=d>>>12,A[m]=_^d;u.w=M,u.X=A,u.i=m}l(s,h)}function a(h,s){return s.i=h.i,s.w=h.w,s.X=h.X.slice(),s}function o(h,s){h==null&&(h=+new Date);var l=new r(h),u=s&&s.state,f=function(){return(l.next()>>>0)/4294967296};return f.double=function(){do var d=l.next()>>>11,_=(l.next()>>>0)/4294967296,m=(d+_)/(1<<21);while(m===0);return m},f.int32=l.next,f.quick=f,u&&(u.X&&a(u,l),f.state=function(){return a(l,{})}),f}e&&e.exports?e.exports=o:this.xor4096=o})(qr,n)}(Kt)),Kt.exports}var Qt={exports:{}},Br=Qt.exports,In;function Pr(){return In||(In=1,function(n){(function(t,e,i){function r(h){var s=this,l="";s.next=function(){var f=s.b,d=s.c,_=s.d,m=s.a;return f=f<<25^f>>>7^d,d=d-_|0,_=_<<24^_>>>8^m,m=m-f|0,s.b=f=f<<20^f>>>12^d,s.c=d=d-_|0,s.d=_<<16^d>>>16^m,s.a=m-f|0},s.a=0,s.b=0,s.c=-1640531527,s.d=1367130551,h===Math.floor(h)?(s.a=h/4294967296|0,s.b=h|0):l+=h;for(var u=0;u<l.length+20;u++)s.b^=l.charCodeAt(u)|0,s.next()}function a(h,s){return s.a=h.a,s.b=h.b,s.c=h.c,s.d=h.d,s}function o(h,s){var l=new r(h),u=s&&s.state,f=function(){return(l.next()>>>0)/4294967296};return f.double=function(){do var d=l.next()>>>11,_=(l.next()>>>0)/4294967296,m=(d+_)/(1<<21);while(m===0);return m},f.int32=l.next,f.quick=f,u&&(typeof u=="object"&&a(u,l),f.state=function(){return a(l,{})}),f}e&&e.exports?e.exports=o:this.tychei=o})(Br,n)}(Qt)),Qt.exports}var Jt={exports:{}};const Rr={},Lr=Object.freeze(Object.defineProperty({__proto__:null,default:Rr},Symbol.toStringTag,{value:"Module"})),zr=si(Lr);var Gr=Jt.exports,Fn;function jr(){return Fn||(Fn=1,function(n){(function(t,e,i){var r=256,a=6,o=52,h="random",s=i.pow(r,a),l=i.pow(2,o),u=l*2,f=r-1,d;function _(S,k,L){var B=[];k=k==!0?{entropy:!0}:k||{};var N=A(M(k.entropy?[S,O(e)]:S==null?I():S,3),B),y=new m(B),p=function(){for(var c=y.g(a),w=s,v=0;c<l;)c=(c+v)*r,w*=r,v=y.g(1);for(;c>=u;)c/=2,w/=2,v>>>=1;return(c+v)/w};return p.int32=function(){return y.g(4)|0},p.quick=function(){return y.g(4)/4294967296},p.double=p,A(O(y.S),e),(k.pass||L||function(c,w,v,F){return F&&(F.S&&b(F,y),c.state=function(){return b(y,{})}),v?(i[h]=c,w):c})(p,N,"global"in k?k.global:this==i,k.state)}function m(S){var k,L=S.length,B=this,N=0,y=B.i=B.j=0,p=B.S=[];for(L||(S=[L++]);N<r;)p[N]=N++;for(N=0;N<r;N++)p[N]=p[y=f&y+S[N%L]+(k=p[N])],p[y]=k;(B.g=function(c){for(var w,v=0,F=B.i,T=B.j,U=B.S;c--;)w=U[F=f&F+1],v=v*r+U[f&(U[F]=U[T=f&T+w])+(U[T]=w)];return B.i=F,B.j=T,v})(r)}function b(S,k){return k.i=S.i,k.j=S.j,k.S=S.S.slice(),k}function M(S,k){var L=[],B=typeof S,N;if(k&&B=="object")for(N in S)try{L.push(M(S[N],k-1))}catch(y){}return L.length?L:B=="string"?S:S+"\0"}function A(S,k){for(var L=S+"",B,N=0;N<L.length;)k[f&N]=f&(B^=k[f&N]*19)+L.charCodeAt(N++);return O(k)}function I(){try{var S;return d&&(S=d.randomBytes)?S=S(r):(S=new Uint8Array(r),(t.crypto||t.msCrypto).getRandomValues(S)),O(S)}catch(B){var k=t.navigator,L=k&&k.plugins;return[+new Date,t,L,t.screen,O(e)]}}function O(S){return String.fromCharCode.apply(0,S)}if(A(i.random(),e),n.exports){n.exports=_;try{d=zr}catch(S){}}else i["seed"+h]=_})(typeof self!="undefined"?self:Gr,[],Math)}(Jt)),Jt.exports}var xe,Tn;function Xr(){if(Tn)return xe;Tn=1;var n=Tr(),t=Mr(),e=Ur(),i=Or(),r=Dr(),a=Pr(),o=jr();return o.alea=n,o.xor128=t,o.xorwow=e,o.xorshift7=i,o.xor4096=r,o.tychei=a,xe=o,xe}var os=Xr(),as=(()=>{for(var n=new Uint8Array(128),t=0;t<64;t++)n[t<26?t+65:t<52?t+71:t<62?t-4:t*4-205]=t;return e=>{for(var i=e.length,r=new Uint8Array((i-(e[i-1]=="=")-(e[i-2]=="="))*3/4|0),a=0,o=0;a<i;){var h=n[e.charCodeAt(a++)],s=n[e.charCodeAt(a++)],l=n[e.charCodeAt(a++)],u=n[e.charCodeAt(a++)];r[o++]=h<<2|s>>4,r[o++]=s<<4|l>>2,r[o++]=l<<6|u}return r}})();export{rs as F,Wr as G,ss as L,D as N,as as _,Ci as a,es as b,pn as c,Vr as d,$r as e,Kr as f,is as g,Jr as h,Xn as i,ts as j,os as k,Ir as l,pt as o,Qr as r,Hr as s,Zr as v};
